# name: test/sql/function/test_as_text.test
# description: ST_ASTEXT test
# group: [function]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE geographies(g Geography)

statement ok
INSERT INTO geographies VALUES('{"type":"Point","coordinates":[30,10.2323]}'), ('{"type":"Point","coordinates":[-71.064544,10.2323]}'), ('{"type":"Point","coordinates":[30,43.28787]}')

query R
select ST_ASTEXT(g) from geographies
----
POINT(30 10.2323)
POINT(-71.064544 10.2323)
POINT(30 43.28787)

# test with null and empty
statement ok
DELETE FROM geographies

statement ok
INSERT INTO geographies VALUES(''), (NULL)

query R
select ST_ASTEXT(g) from geographies
----
(empty)
NULL

query I
SELECT ST_ASTEXT(ST_MAKEPOINT(5.04, 10.94))
----
POINT(5.04 10.94)

query I
SELECT ST_ASTEXT('0101000000295C8FC2F5281440E17A14AE47E12540')
----
POINT(5.04 10.94)

query I
SELECT ST_ASTEXT('010400000004000000010100000000000000000034400000000000003440010100000000000000000034400000000000003e4001010000000000000000003e400000000000003440010100000000000000008056400000000000805640')
----
MULTIPOINT(20 20,20 30,30 20,90 90)

query I
SELECT ST_ASTEXT('01020000000100000000000000000041400000000000003540')
----
LINESTRING(34 21)

query I
SELECT ST_ASTEXT('010500000001000000010200000003000000e44a3d0b42ca51c06ec328081e21454027bf45274bca51c0f67b629d2a214540957cec2e50ca51c07099d36531214540')
----
MULTILINESTRING((-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))

query I
SELECT ST_ASTEXT('0103000000020000000500000000000000000000000000000000000000000000000000000000000000000049400000000000c0624000000000000049400000000000c06240000000000000000000000000000000000000000000000000050000000000000000003440000000000000344000000000000049400000000000003440000000000000494000000000000049400000000000003440000000000000494000000000000034400000000000003440')
----
POLYGON((0 0,0 50,150 50,150 0,0 0),(20 20,50 20,50 50,20 50,20 20))

query I
SELECT ST_ASTEXT('010700000003000000010200000004000000ec51b81e85eb074000000000008056400000000000c0514000000000008052400000000000003440000000000000444000000000006065400000000000004b400101000000ec51b81e85eb0740000000000080564001030000000100000004000000c3f5285c8fea6340b81e85eb51d84f4000000000006065400000000000004b4052b81e85eb2964400ad7a3703d2a4540c3f5285c8fea6340b81e85eb51d84f40')
----
GEOMETRYCOLLECTION(LINESTRING(2.99 90,71 74,20 40,171 54),POINT(2.99 90),POLYGON((159.33 63.69,171 54,161.31 42.33,159.33 63.69)))

statement error
SELECT ST_ASTEXT('aaa')

query I
SELECT ST_ASTEXT(NULL)
----
NULL

query I
SELECT ST_ASTEXT('')
----
(empty)

#test with invalid input
statement error
SELECT ST_ASTEXT(22)
