# name: test/sql/test_union.test
# description: ST_UNION test
# group: [sql]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

#test with POINT
#to POINT
query I
SELECT ST_ASTEXT(ST_UNION('POINT(100 10)', 'POINT(100 81)'))
----
MULTIPOINT(100 10,100 81)

#to LINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('POINT(30 1)', 'LINESTRING(30 10.2323, -72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)'))
----
GEOMETRYCOLLECTION(POINT(30 1),LINESTRING(30 10.2323,-72.126 42.45,-72.124 42.45666,-72.123 42.1546))

#to POLYGON
query I
SELECT ST_ASTEXT(ST_UNION('POINT(30 10.2323)', '{"type":"Polygon","coordinates":[[[0,0],[0,50],[150,50],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}'))
----
GEOMETRYCOLLECTION(POLYGON((0 50,20 50,20 20,50 20,50 50,150 50,150 0,0 0,0 50)),LINESTRING(20 50,50 50))

#to MULTIPOINT
query I
SELECT ST_ASTEXT(ST_UNION('POINT(30 10.2323)', 'MULTIPOINT(35 10,45 45,15 40,10 20,35 10,20 30,35 35,30 20,20 30)'))
----
MULTIPOINT(30 10.2323,10 20,15 40,20 30,30 20,35 10,35 35,45 45)

#to MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('POINT(30 10.2323)', '{"type":"MultiLineString","coordinates":[[[30,10.2323],[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}'))
----
LINESTRING(30 10.2323,-89.734635 31.492072,-89.734956 31.492237999999997)

#to MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_UNION('POINT(30 10.2323)', '{"type":"MultiPolygon","coordinates":[[[[0,0],[0,50],[150,50],[150,0],[0,0]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}'))
----
POLYGON((0 50,150 50,150 0,0 0,0 50))

#to COLLECTION
query I
SELECT ST_ASTEXT(ST_UNION('POINT(30 10.2323)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))'))
----
GEOMETRYCOLLECTION(POINT(30 10.2323),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))

#test with LINESTRING
#to POINT
query I
SELECT ST_ASTEXT(ST_UNION('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'POINT(35.3933982822018 35.3933982822018)'))
----
LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46,31 90)

#to LINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307)'))
----
MULTILINESTRING((164 31,46 31),(46 31,40.2597485145236 32.1418070123307),(40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46,31 90))

#to POLYGON
query I
SELECT ST_ASTEXT(ST_UNION('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', '{"type":"Polygon","coordinates":[[[0,0],[0,10],[150,10],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}'))
----
GEOMETRYCOLLECTION(LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46,31 90),POLYGON((0 0,0 10,150 10,150 0,0 0),(20 20,50 20,50 50,20 50,20 20)))

#to MULTIPOINT
query I
SELECT ST_ASTEXT(ST_UNION('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'MULTIPOINT(40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237)'))
----
LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46,31 90)

#to MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'MULTILINESTRING((164 31,60 31),(46 31,40.2597485145236 32.1418070123307,31 46,31 90))'))
----
MULTILINESTRING((164 31,60 31),(60 31,46 31),(46 31,40.2597485145236 32.1418070123307),(40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46),(31 46,31 90),(40.2597485145236 32.1418070123307,31 46))

#to MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_UNION('LINESTRING(16.4 3.1,4.6 3.1,4.02597485145236 3.21418070123307, 3.53933982822018 3.53933982822018, 3.21418070123307 4.02597485145237,3.1 4.6,3.1 19.5)', 'MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0),(0.5 0.5, 0.5 0.6, 0.6 0.6, 0.8 0.5, 0.5 0.5)),((10 10, 10 13, 13 13, 13 10, 4.6 3.1, 3.1 19.5, 10 10)))'))
----
GEOMETRYCOLLECTION(POLYGON((0 1,1 1,1 0,0 0,0 1),(0.8 0.5,0.6 0.6,0.5 0.6,0.5 0.5,0.8 0.5)),POLYGON((10 13,13 13,13 10,4.6 3.1,3.1 19.5,10 10,10 13)),LINESTRING(16.4 3.1,4.6 3.1),LINESTRING(4.6 3.1,4.02597485145236 3.21418070123307,3.53933982822018 3.53933982822018,3.21418070123307 4.02597485145237,3.1 4.6,3.1 19.5))

#to COLLECTION
query I
SELECT ST_ASTEXT(ST_UNION('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)), POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)), LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018))'))
----
GEOMETRYCOLLECTION(LINESTRING(164 31,46 31),LINESTRING(46 31,40.2597485145236 32.1418070123307),LINESTRING(40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018),LINESTRING(35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46,31 90),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)))

#test with POLYGON
#to POINT
query I
SELECT ST_ASTEXT(ST_UNION('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'POINT(-71.170511 42.354855)'))
----
POLYGON((-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675,-71.172026 42.354044))

#to LINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'LINESTRING(-72.1260 42.45, -71.17112 42.354238, -72.1240 42.45666, -72.123 42.1546)'))
----
GEOMETRYCOLLECTION(POLYGON((-71.172026 42.354044,-71.17239 42.354358,-71.17238347594378 42.35436471014508,-71.17237546825923 42.35437294623672,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675,-71.172026 42.354044)),LINESTRING(-72.126 42.45,-72.12397727983702 42.449797147570116),LINESTRING(-72.12397727983702 42.449797147570116,-71.17238347594378 42.35436471014508),LINESTRING(-71.17237546825923 42.35437294623672,-72.124 42.45666,-72.12397727983702 42.449797147570116),LINESTRING(-72.12397727983702 42.449797147570116,-72.123 42.1546))

#to POLYGON
query I
SELECT ST_ASTEXT(ST_UNION('{"type":"Polygon","coordinates":[[[0,0],[0,17],[170,17],[170,0],[0,0]]]}', '{"type":"Polygon","coordinates":[[[0,0],[0,15],[150,15],[150,0],[0,0]],[[20,2],[50,2],[50,5],[20,5],[20,2]]]}'))
----
POLYGON((0 15,0 17,170 17,170 0,150 0,0 0,0 15))

#to MULTIPOINT
query I
SELECT ST_ASTEXT(ST_UNION('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOINT(-70.9590 42.1180, -70.9611 42.1223, -71.172026 42.354044)'))
----
GEOMETRYCOLLECTION(POLYGON((-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675,-71.172026 42.354044)),POINT(-70.9611 42.1223),POINT(-70.959 42.118))

#to MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-71.172026, 42.354044],[-71.17239,42.354358], [-71.17166,42.353675],[-89.734955999999997,31.492237999999997]]]}'))
----
GEOMETRYCOLLECTION(POLYGON((-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675,-71.172026 42.354044)),LINESTRING(-89.734635 31.492072,-82.72500195023441 35.59378194372765),LINESTRING(-82.72500195023441 35.59378194372765,-71.1720434677223 42.35403377870457),LINESTRING(-71.1720434677223 42.35403377870457,-71.172026 42.354044),LINESTRING(-71.17239 42.354358,-71.1720434677223 42.35403377870457),LINESTRING(-71.1720434677223 42.35403377870457,-71.17166 42.353675),LINESTRING(-71.17166 42.353675,-82.72500195023441 35.59378194372765),LINESTRING(-82.72500195023441 35.59378194372765,-89.734956 31.492237999999997))

#to MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_UNION('POLYGON((-71.17166 42.353675,-71.172026 40.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOLYGON(((0 0, 10 0, 10 10, 0 10, 0 0),(5 5, 5 6, 6 6, 8 5, 5 5)),((10.0 10.0, 10.0 13.0, 13.0 13.0, 13.0 10.0, 10.0 10.0)),((-71.17166 42.353675,-71.172026 40.354044,-71.17239 42.354358,-71.17166 42.353675)))'))
----
MULTIPOLYGON(((-71.172026 40.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675,-71.172026 40.354044)),((10 0,0 0,0 10,10 10,10 0),(8 5,6 6,5 6,5 5,8 5)),((10 13,13 13,13 10,10 10,10 13)))

#to COLLECTION
query I
SELECT ST_ASTEXT(ST_UNION('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'GEOMETRYCOLLECTION(POLYGON((-71.172026 42.354044, -71.040943 42.2856,-71.04096 42.285752,-71.172026 42.354044)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932, -71.170511 42.354855))'))
----
GEOMETRYCOLLECTION(LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932,-71.17034544741969 42.35316651214264),LINESTRING(-71.17034563704019 42.35316844610157,-71.170511 42.354855),POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17154597427665 42.35379388237454,-71.17034563704019 42.35316844610157,-71.04096 42.285752,-71.040943 42.2856,-71.17034544741969 42.35316651214264,-71.17154630927668 42.35379353310599,-71.17166 42.353675)))

#test with MULTIPOINT
#to POINT
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOINT(6.0 12.0,11.0 12.0,16.0 12.0)', 'POINT(11.0 12.1)'))
----
MULTIPOINT(6 12,11 12,16 12,11 12.1)

#to LINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOINT(6.0 12.0,11.0 12.0,16.0 12.0)', 'LINESTRING(6.0 12.0,11.0 12.0)'))
----
GEOMETRYCOLLECTION(LINESTRING(6 12,11 12),POINT(16 12))

#to POLYGON
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOINT(6.0 12.0,11.0 12.0,16.0 12.0)', '{"type":"Polygon","coordinates":[[[0,0],[0,15.0],[15.0,15.0],[15.0,0],[0,0]],[[2.0,2.0],[5.0,2.0],[5.0,5.0],[2.0,5.0],[2.0,2.0]]]}'))
----
GEOMETRYCOLLECTION(POLYGON((0 15,15 15,15 0,0 0,0 15),(5 2,5 5,2 5,2 2,5 2)),POINT(16 12))

#to MULTIPOINT
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOINT(6.0 12.0,11.0 12.0,16.0 12.0)', 'MULTIPOINT((0 0), (1 1), (2 2), (20.0 20.0), (16.0 12.0))'))
----
MULTIPOINT(6 12,11 12,16 12,0 0,1 1,2 2,20 20)

#to MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOINT(6.0 12.0,11.0 12.0,16.0 12.0)', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}'))
----
GEOMETRYCOLLECTION(POINT(6 12),POINT(11 12),POINT(16 12),LINESTRING(-89.734635 31.492072,-89.734956 31.492237999999997))

#to MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOINT(0 12.0)', 'MULTIPOLYGON(((2.6 12.5, 2.6 20.0, 12.6 20.0, 6.0 12.0, 12.6 12.5, 2.6 12.5),(5.1 15.0, 10.1 15.0, 7.6 17.5, 5.1 15.0 )),((15.1 10.0, 15.1 20.0, 16.0 12.0, 17.6 17.5, 15.1 10.0)))'))
----
GEOMETRYCOLLECTION(POINT(0 12),POLYGON((2.6 12.5,2.6 20,12.6 20,6 12,12.6 12.5,2.6 12.5),(5.1 15,10.1 15,7.6 17.5,5.1 15)),POLYGON((15.1 10,15.1 20,16 12,17.6 17.5,15.1 10)))

#to COLLECTION
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOINT(6.0 12.0,11.0 12.0,16.0 12.0)', 'GEOMETRYCOLLECTION(LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932, 6.0 12.0),MULTIPOINT(6.0 12.0,11.0 12.0))'))
----
GEOMETRYCOLLECTION(POINT(11 12),POINT(16 12),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932,6 12))

#test with MULTILINESTRING
#to POINT
query I
SELECT ST_ASTEXT(ST_UNION('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'POINT(10.6 16.4)'))
----
MULTILINESTRING((10.6 16.4,6.914000000000001 13.878),(6.914000000000001 13.878,3 11.2,7.4 7,8.2 11.2,13 9.4,13 6.2,12.2 4,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15 13,17 14.2,17.4 11,15.6 9.6,15.8 9,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3,13.2 1,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19 10,19 12.2,18.2 14.8,17.8 17,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15,6.2 15,6.914000000000001 13.878),(6.914000000000001 13.878,7.6 12.8,8.8 11.8))

#to LINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'LINESTRING(10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8)'))
----
MULTILINESTRING((10.6 16.4,6.914000000000001 13.878),(6.914000000000001 13.878,3 11.2),(3 11.2,7.4 7),(7.4 7,8.2 11.2),(8.2 11.2,13 9.4),(13 9.4,13 6.2),(13 6.2,12.2 4),(12.2 4,15.6 3.2),(15.6 3.2,16.2 7.6),(16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15 13,17 14.2,17.4 11,15.6 9.6,15.8 9,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3,13.2 1,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19 10,19 12.2,18.2 14.8,17.8 17,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15,6.2 15,6.914000000000001 13.878),(6.914000000000001 13.878,7.6 12.8,8.8 11.8))

#to POLYGON
query I
SELECT ST_ASTEXT(ST_UNION('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'POLYGON((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8, 10.6 16.4))'))
----
GEOMETRYCOLLECTION(POLYGON((10.6 16.4,12.884615384615385 13.769230769230768,14.297872340425531 12.141843971631205,16.140314136125653 10.020244328097732,17.2 8.8,16.2 7.6,15.6 3.2,12.2 4,13 6.2,13 9.4,8.2 11.2,7.4 7,3 11.2,6.914000000000001 13.878,10.6 16.4)),LINESTRING(13.2 17.8,13.4 14.8,12.884615384615385 13.769230769230768),LINESTRING(14.297872340425531 12.141843971631205,15 13,17 14.2,17.4 11,16.140314136125653 10.020244328097732),LINESTRING(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3,13.2 1,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19 10,19 12.2,18.2 14.8,17.8 17,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15,6.2 15,6.914000000000001 13.878))

#to MULTIPOINT
query I
SELECT ST_ASTEXT(ST_UNION('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'MULTIPOINT(8.8 11.8, -7.09611 4.21223, -7.1172026 4.2354044, 13.2 10.8)'))
----
GEOMETRYCOLLECTION(LINESTRING(10.6 16.4,6.914000000000001 13.878),LINESTRING(6.914000000000001 13.878,3 11.2,7.4 7,8.2 11.2,13 9.4,13 6.2,12.2 4,15.6 3.2,16.2 7.6,17.2 8.8),LINESTRING(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15 13,17 14.2,17.4 11,15.6 9.6,15.8 9,15.8 8.8),LINESTRING(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3,13.2 1,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19 10,19 12.2,18.2 14.8,17.8 17,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15,6.2 15,6.914000000000001 13.878),LINESTRING(6.914000000000001 13.878,7.6 12.8,8.8 11.8),POINT(-7.1172026 4.2354044),POINT(-7.09611 4.21223))

#to MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'MULTILINESTRING((16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))'))
----
MULTILINESTRING((10.6 16.4,6.914000000000001 13.878),(6.914000000000001 13.878,3 11.2,7.4 7,8.2 11.2,13 9.4,13 6.2,12.2 4,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15 13,17 14.2,17.4 11,15.6 9.6,15.8 9,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3,13.2 1,16.8 1.8),(16.8 1.8,17.8 3.4),(17.8 3.4,18.6 5.2),(18.6 5.2,18.4 7.4),(18.4 7.4,19 10),(19 10,19 12.2),(19 12.2,18.2 14.8),(18.2 14.8,17.8 17),(17.8 17,17.6 18.4),(17.6 18.4,15.6 16.4),(15.6 16.4,14.6 17.8),(14.6 17.8,13.2 18.6),(13.2 18.6,9.2 18.2),(9.2 18.2,5.6 15.8),(5.6 15.8,3.6 15),(3.6 15,6.2 15),(6.2 15,6.914000000000001 13.878),(6.914000000000001 13.878,7.6 12.8),(7.6 12.8,8.8 11.8))

#to MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_UNION('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'MULTIPOLYGON(((0 0, 10 0, 10 10, 0 10, 0 0),(5 5, 5 6, 6 6, 8 5, 5 5)),((10.0 10.0, 10.0 13.0, 13.0 13.0, 13.0 10.0, 10.0 10.0)))'))
----
GEOMETRYCOLLECTION(POLYGON((10 0,0 0,0 10,4.257142857142857 10,7.971428571428572 10,10 10,10 7.04,10 0),(8 5,6 6,5 6,5 5,8 5)),POLYGON((10 10.525,10 12.577777777777778,10 12.9,10 13,10.399999999999999 13,13 13,13 10.911111111111111,13 10,11.4 10,10 10,10 10.525)),LINESTRING(10.6 16.4,6.914000000000001 13.878),LINESTRING(6.914000000000001 13.878,3 11.2,4.257142857142857 10),LINESTRING(7.971428571428572 10,8.2 11.2,10 10.525),LINESTRING(11.4 10,13 9.4,13 6.2,12.2 4,15.6 3.2,16.2 7.6,17.2 8.8),LINESTRING(13.2 17.8,13.4 14.8,12.8 13.6,10.399999999999999 13),LINESTRING(10 12.9,9.6 12.8,10 12.577777777777778),LINESTRING(13 10.911111111111111,13.2 10.8,15 13,17 14.2,17.4 11,15.6 9.6,15.8 9,15.8 8.8),LINESTRING(10 7.04,11.4 7.6,11.2 3,13.2 1,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19 10,19 12.2,18.2 14.8,17.8 17,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15,6.2 15,6.914000000000001 13.878),LINESTRING(6.914000000000001 13.878,7.6 12.8,8.8 11.8))

#to COLLECTION
query I
SELECT ST_ASTEXT(ST_UNION('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'GEOMETRYCOLLECTION(MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8)),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))'))
----
GEOMETRYCOLLECTION(LINESTRING(10.6 16.4,6.914000000000001 13.878),LINESTRING(6.914000000000001 13.878,3 11.2),LINESTRING(3 11.2,7.4 7),LINESTRING(7.4 7,8.2 11.2),LINESTRING(8.2 11.2,13 9.4),LINESTRING(13 9.4,13 6.2),LINESTRING(13 6.2,12.2 4),LINESTRING(12.2 4,15.6 3.2),LINESTRING(15.6 3.2,16.2 7.6),LINESTRING(16.2 7.6,17.2 8.8),LINESTRING(13.2 17.8,13.4 14.8),LINESTRING(13.4 14.8,12.8 13.6),LINESTRING(12.8 13.6,9.6 12.8),LINESTRING(9.6 12.8,13.2 10.8),LINESTRING(13.2 10.8,15 13),LINESTRING(15 13,17 14.2),LINESTRING(17 14.2,17.4 11),LINESTRING(17.4 11,15.6 9.6),LINESTRING(15.6 9.6,15.8 9),LINESTRING(15.8 9,15.8 8.8),LINESTRING(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3,13.2 1,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19 10,19 12.2,18.2 14.8,17.8 17,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15,6.2 15,6.914000000000001 13.878),LINESTRING(6.914000000000001 13.878,7.6 12.8,8.8 11.8),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)))

#test with MULTIPOLYGON
#to POINT
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'POINT(12.6 20.0)'))
----
MULTIPOLYGON(((2.6 20,12.6 20,12.6 12.5,10.1 10,2.6 12.5,2.6 20),(10.1 15,7.6 17.5,5.1 15,10.1 15)),((15.1 20,17.6 17.5,15.1 10,15.1 20)))

#to LINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'LINESTRING(-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446)'))
----
MULTIPOLYGON(((-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043)),((-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857)))

#to POLYGON
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'POLYGON((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5))'))
----
MULTIPOLYGON(((2.6 20,12.6 20,12.6 12.5,10.1 10,2.6 12.5,2.6 20)),((15.1 20,17.6 17.5,15.1 10,15.1 20)))

#to MULTIPOINT
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'MULTIPOINT(8.8 11.8, -7.09611 4.21223, 12.6 20.0, -7.1172026 4.2354044, 13.2 10.8)'))
----
GEOMETRYCOLLECTION(POLYGON((2.6 20,12.6 20,12.6 12.5,10.1 10,2.6 12.5,2.6 20),(10.1 15,7.6 17.5,5.1 15,10.1 15)),POLYGON((15.1 20,17.6 17.5,15.1 10,15.1 20)),POINT(-7.1172026 4.2354044),POINT(-7.09611 4.21223),POINT(13.2 10.8))

#to MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', '{"type":"MultiLineString","coordinates":[[[-71.1043632495873,42.315113108546],[-89.734634999999997,31.492072000000000],[-71.10277487471,42.3141658254797],[-89.734955999999997,31.492237999999997]]]}'))
----
GEOMETRYCOLLECTION(POLYGON((-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043)),POLYGON((-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857)),LINESTRING(-71.1043632495873 42.315113108546,-86.77996933505653 33.20855087814541),LINESTRING(-86.77996933505653 33.20855087814541,-89.734635 31.492072,-71.10277487471 42.3141658254797),LINESTRING(-71.10277487471 42.3141658254797,-86.77996933505653 33.20855087814541),LINESTRING(-86.77996933505653 33.20855087814541,-89.734956 31.492237999999997))

#to MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)))'))
----
MULTIPOLYGON(((2.6 20,12.6 20,12.6 12.5,10.1 10,2.6 12.5,2.6 20),(10.1 15,7.6 17.5,5.1 15,10.1 15)),((15.1 20,17.6 17.5,15.1 10,15.1 20)))

#to COLLECTION
query I
SELECT ST_ASTEXT(ST_UNION('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'GEOMETRYCOLLECTION(POLYGON((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.103396240451 42.3138632439557,-71.1031880899493 42.3152774590236)),LINESTRING(-71.1038734225584 42.3151140942995,-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))'))
----
GEOMETRYCOLLECTION(LINESTRING(-71.10416413358058 42.31482349914999,-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),POLYGON((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.10416413358058 42.31482349914999,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),POLYGON((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))

#test with COLLECTION
#to POINT
query I
SELECT ST_ASTEXT(ST_UNION('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(10.0 10.0),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POINT(78.26 40.98)'))
----
GEOMETRYCOLLECTION(POINT(10 10),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)))

#to LINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', 'LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932)'))
----
GEOMETRYCOLLECTION(LINESTRING(-71.160281 42.258729,-71.160837 42.259113),LINESTRING(-71.160837 42.259113,-71.161144 42.25932),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)))

#to POLYGON
query I
SELECT ST_ASTEXT(ST_UNION('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98))'))
----
GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)))

#to MULTIPOINT
query I
SELECT ST_ASTEXT(ST_UNION('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)) )', 'MULTIPOINT(5 90,5 90,2.5 16.9,-71.1776820268866 42.3903701743239)'))
----
GEOMETRYCOLLECTION(POINT(5 90),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)))

#to MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_UNION('GEOMETRYCOLLECTION(LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546), POINT(-72.1235 42.3521),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTILINESTRING((-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546, -72.1235 42.3521))'))
----
GEOMETRYCOLLECTION(LINESTRING(-72.126 42.45,-72.124 42.45666),LINESTRING(-72.124 42.45666,-72.123 42.1546),LINESTRING(-72.123 42.1546,-72.1235 42.3521),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)))

#to MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_UNION('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTIPOLYGON(((78.26 40.98,83.98 50.74,86 43,78.26 40.98)),((5 90,10 89,10 90,5 90)),((5 90,0 41,0 90,5 90)))'))
----
GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)),POLYGON((5 90,10 90,10 89,5 90)),POLYGON((5 90,0 41,0 90,5 90)))

#to COLLECTION
query I
SELECT ST_ASTEXT(ST_UNION('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)) )', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),POINT(2.5 16.9))'))
----
GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)))

#test with NULL and empty value
query I
SELECT ST_UNION('', 'GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')
----
(empty)

query I 
SELECT ST_UNION(NULL, NULL)
----
NULL

# test with invalid input
statement error
SELECT ST_UNION(22, 'GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

statement error
SELECT ST_UNION('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

# test with table
statement ok
CREATE TABLE geographies (g Geography);

statement ok
INSERT INTO geographies VALUES('MULTIPOINT(0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9)'::GEOGRAPHY), ('LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3)'::GEOGRAPHY), ('01010000000000000000003E40BBB88D06F0762440'), ('POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678))'::GEOGRAPHY), ('0101000000CB49287D21C451C0F0BF95ECD8A44540')

query R
SELECT ST_ASTEXT(ST_UNION(g, 'GEOMETRYCOLLECTION(POINT(0.9 0.9),LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)) )')) FROM geographies
----
GEOMETRYCOLLECTION(POINT(0.9 0.9),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)))
GEOMETRYCOLLECTION(POINT(0.9 0.9),LINESTRING(2.5 16.9,8.9 11.4),LINESTRING(8.9 11.4,4 7),LINESTRING(4 7,8.6 4.3),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)))
GEOMETRYCOLLECTION(POINT(30 10.2323),POINT(0.9 0.9),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)))
GEOMETRYCOLLECTION(POINT(0.9 0.9),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)))
GEOMETRYCOLLECTION(POINT(-71.064544 43.28787),POINT(0.9 0.9),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)))

statement ok
INSERT INTO geographies VALUES(''::GEOGRAPHY), (NULL::GEOGRAPHY), ('MULTIPOLYGON(((5 90,10 90,10 89,5 90)),((5 90,0 90,0 41,5 90)))')

query R
SELECT ST_ASTEXT(ST_UNION(g, 'GEOMETRYCOLLECTION(POLYGON((10 90,10 89,5 90,10 90)),LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(-71.064544 43.28787))')) FROM geographies
----
GEOMETRYCOLLECTION(POINT(0.9 0.9),POINT(0.9 0.9),POINT(0.9 0.9),POINT(0.9 0.9),POINT(0.9 0.9),POINT(0.9 0.9),POLYGON((10 90,10 89,5 90,10 90)),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POINT(-71.064544 43.28787))
GEOMETRYCOLLECTION(POINT(-71.064544 43.28787),LINESTRING(2.5 16.9,8.9 11.4),LINESTRING(8.9 11.4,4 7),LINESTRING(4 7,8.6 4.3),POLYGON((10 90,10 89,5 90,10 90)))
GEOMETRYCOLLECTION(POINT(30 10.2323),POLYGON((10 90,10 89,5 90,10 90)),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POINT(-71.064544 43.28787))
GEOMETRYCOLLECTION(POINT(-71.064544 43.28787),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),POLYGON((10 90,10 89,5 90,10 90)))
GEOMETRYCOLLECTION(POINT(-71.064544 43.28787),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((10 90,10 89,5 90,10 90)))
(empty)
NULL
GEOMETRYCOLLECTION(POINT(-71.064544 43.28787),LINESTRING(2.5 16.9,8.9 11.4,4 7,8.6 4.3),POLYGON((5 90,10 90,10 89,5 90)),POLYGON((5 90,0 41,0 90,5 90)))

query I
SELECT ST_ASTEXT(ST_UNION(['MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))'::GEOGRAPHY, 'POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))'::GEOGRAPHY, 'POINT(30 10.2323)'::GEOGRAPHY]))
----
GEOMETRYCOLLECTION(POINT(30 10.2323),POLYGON((2.6 20,12.6 20,12.6 12.5,10.1 10,2.6 12.5,2.6 20),(10.1 15,7.6 17.5,5.1 15,10.1 15)),POLYGON((17.6 17.5,15.1 10,15.1 20,17.6 17.5)),POLYGON((-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358)))

query I
SELECT ST_ASTEXT(ST_UNION(['MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))'::GEOGRAPHY]))
----
MULTIPOLYGON(((2.6 12.5,2.6 20,12.6 20,12.6 12.5,10.1 10,2.6 12.5),(5.1 15,10.1 15,7.6 17.5,5.1 15)),((15.1 10,15.1 20,17.6 17.5,15.1 10)))

query I
SELECT ST_ASTEXT(ST_UNION([]))
----
(empty)
