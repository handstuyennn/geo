# name: test/sql/test_equals.test
# description: ST_EQUALS test
# group: [sql]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

#test with POINT
#to POINT
query I
SELECT ST_EQUALS('POINT(30 10.2323)', 'POINT(30 10.2323)')
----
1

#to LINESTRING
query I
SELECT ST_EQUALS('POINT(30 10.2323)', 'LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)')
----
0

#to POLYGON
query I
SELECT ST_EQUALS('POINT(30 10.2323)', '{"type":"Polygon","coordinates":[[[0,0],[0,50],[150,50],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}')
----
0

#to MULTIPOINT
query I
SELECT ST_EQUALS('POINT(30 10.2323)', 'MULTIPOINT(30 10.2323)')
----
1

#to MULTILINESTRING
query I
SELECT ST_EQUALS('POINT(30 10.2323)', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}')
----
0

#to MULTIPOLYGON
query I
SELECT ST_EQUALS('POINT(30 10.2323)', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
0

#to COLLECTION
query I
SELECT ST_EQUALS('POINT(30 10.2323)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))')
----
0

#test with LINESTRING
#to POINT
query I
SELECT ST_EQUALS('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'POINT(35.3933982822018 35.3933982822018)')
----
0

#to LINESTRING
query I
SELECT ST_EQUALS('LINESTRING(0 0, 5 5, 10 10)', 'LINESTRING(0 0, 10 10)')
----
1

#to POLYGON
query I
SELECT ST_EQUALS('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', '{"type":"Polygon","coordinates":[[[0,0],[0,50],[150,50],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}')
----
0

#to MULTIPOINT
query I
SELECT ST_EQUALS('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'MULTIPOINT(164 31,46 31, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237)')
----
0

#to MULTILINESTRING
query I
SELECT ST_EQUALS('LINESTRING(0 0, 5 5, 10 10)', 'MULTILINESTRING((0 0, 5 5, 10 10))')
----
1

#to MULTIPOLYGON
query I
SELECT ST_EQUALS('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]],[[31,46], [31,90],[31,90], [31,46]]]]}')
----
0

#to COLLECTION
query I
SELECT ST_EQUALS('LINESTRING(-72.1260 42.45, -72.123 42.1546)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)), POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)))')
----
0

#test with POLYGON
#to POINT
query I
SELECT ST_EQUALS('POLYGON((0 0,0 10,100 20, 160 20, 160 10, 100 10,100 0, 0 0))', 'POINT(50 50)')
----
0

#to LINESTRING
query I
SELECT ST_EQUALS('POLYGON((0 0,0 10,100 20, 160 20, 160 10, 100 10,100 0, 0 0))', 'LINESTRING(3 3, 50 50, 100 10)')
----
0

#to POLYGON
query I
SELECT ST_EQUALS('{"type":"Polygon","coordinates":[[[0,0],[0,70],[170,70],[170,0],[0,0]]]}', '{"type":"Polygon","coordinates":[[[0,0],[170,0],[170,70],[0,70],[0,0]]]}')
----
1

#to MULTIPOINT
query I
SELECT ST_EQUALS('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOINT(-71.17166 42.353675, -71.172026 42.354044)')
----
0

#to MULTILINESTRING
query I
SELECT ST_EQUALS('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTILINESTRING((-29 -27,-30 -29.7,-36 -31,-45 -33),(-45 -33,-46 -32))')
----
0

#to MULTIPOLYGON
query I
SELECT ST_EQUALS('POLYGON((-71.17166 42.353675,-71.172026 40.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOLYGON(((-71.17166 42.353675,-71.172026 40.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)))')
----
1

#to COLLECTION
query I
SELECT ST_EQUALS('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'GEOMETRYCOLLECTION(POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))')
----
0

#test with MULTIPOINT
#to POINT
query I
SELECT ST_EQUALS('MULTIPOINT(60 10,110 10,160 10)', 'POINT(110 10)')
----
0

#to LINESTRING
query I
SELECT ST_EQUALS('MULTIPOINT(60 10,110 10,160 10)', 'LINESTRING(60 10,110 10)')
----
0

#to POLYGON
query I
SELECT ST_EQUALS('MULTIPOINT(-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397)', '{"type":"Polygon","coordinates":[[[60,12],[0,15],[150,15],[150,0],[60,12]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}')
----
0

#to MULTIPOINT
query I
SELECT ST_EQUALS('MULTIPOINT(60 12,110 12,160 12)', 'MULTIPOINT(110 12, 160 12, 60 12)')
----
1

#to MULTILINESTRING
query I
SELECT ST_EQUALS('MULTIPOINT(6 12,11 12,16 12)', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}')
----
0

#to MULTIPOLYGON
query I
SELECT ST_EQUALS('MULTIPOINT(60 12,110 12,160 12)', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
0

#to COLLECTION
query I
SELECT ST_EQUALS('MULTIPOINT(60 12,110 12,160 12)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),MULTIPOINT(60 12,110 12))')
----
0

#test with MULTILINESTRING
#to POINT
query I
SELECT ST_EQUALS('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'POINT(119 11)')
----
0

#to LINESTRING
query I
SELECT ST_EQUALS('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'LINESTRING(3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6)')
----
0

#to POLYGON
query I
SELECT ST_EQUALS('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'POLYGON((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8, 10.6 16.4))')
----
0

#to MULTIPOINT
query I
SELECT ST_EQUALS('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'MULTIPOINT(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0)')
----
0

#to MULTILINESTRING
query I
SELECT ST_EQUALS('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))')
----
1

#to MULTIPOLYGON
query I
SELECT ST_EQUALS('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
0

#to COLLECTION
query I
SELECT ST_EQUALS('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'GEOMETRYCOLLECTION(MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8)),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))')
----
0

#test with MULTIPOLYGON
#to POINT
query I
SELECT ST_EQUALS('MULTIPOLYGON(((2.6 12.5, 2.6 20.0, 12.6 20.0, 12.6 12.5, 2.6 12.5),(5.1 15.0, 10.1 15.0, 7.6 17.5, 5.1 15.0 )),((15.1 10.0, 15.1 20.0, 17.6 17.5, 15.1 10.0)))', 'POINT(2.7 12.6)')
----
0

#to LINESTRING
query I
SELECT ST_EQUALS('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'LINESTRING(-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446)')
----
0

#to POLYGON
query I
SELECT ST_EQUALS('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)))', 'POLYGON((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0, 7.6 17.5,10.1 15.0,5.1 15.0))')
----
1

#to MULTIPOINT
query I
SELECT ST_EQUALS('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'MULTIPOINT(12.6 20.0, 15.1 20.0)')
----
0

#to MULTILINESTRING
query I
SELECT ST_EQUALS('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}')
----
0

#to MULTIPOLYGON
query I
SELECT ST_EQUALS('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)))')
----
0

#to COLLECTION
query I
SELECT ST_EQUALS('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))')
----
0

#test with COLLECTION
#to POINT
query I
SELECT ST_EQUALS('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(10.0 10.0),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POINT(10.0 10.0)')
----
0

#to LINESTRING
query I
SELECT ST_EQUALS('GEOMETRYCOLLECTION(LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', 'LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932)')
----
1

#to POLYGON
query I
SELECT ST_EQUALS('GEOMETRYCOLLECTION(POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98))')
----
1

#to MULTIPOINT
query I
SELECT ST_EQUALS('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)) )', 'MULTIPOINT(5 89,5 90)')
----
0

#to MULTILINESTRING
query I
SELECT ST_EQUALS('GEOMETRYCOLLECTION(LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546), POINT(-72.1235 42.3521),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTILINESTRING((-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546, -72.1235 42.3521))')
----
0

#to MULTIPOLYGON
query I
SELECT ST_EQUALS('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTIPOLYGON(((78.26 40.98,83.98 50.74,86 43,78.26 40.98)),((5 90,10 89,10 90,5 90)),((5 90,0 41,0 90,5 90)))')
----
0

#to COLLECTION
query I
SELECT ST_EQUALS('GEOMETRYCOLLECTION(LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546), POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)) )', 'GEOMETRYCOLLECTION(POINT(2.5 16.9),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)),LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546))')
----
1

#test with NULL and empty value
query I
SELECT ST_EQUALS('', 'GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')
----
0

query I 
SELECT ST_EQUALS(NULL, NULL)
----
NULL

# test with invalid input
statement error
SELECT ST_EQUALS(22, 'GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

statement error
SELECT ST_EQUALS('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

# test with table
statement ok
CREATE TABLE geographies (g Geography);

statement ok
INSERT INTO geographies VALUES('MULTIPOINT(89 11.4,0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9)'::GEOGRAPHY), ('LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3)'::GEOGRAPHY), ('01010000000000000000003E40BBB88D06F0762440'), ('POLYGON((5 90,10 90,10 89,5 90))'::GEOGRAPHY), ('0101000000CB49287D21C451C0F0BF95ECD8A44540')

query R
SELECT ST_EQUALS(g, 'MULTIPOINT(89 11.4,0.9 0.9)') FROM geographies
----
1
0
0
0
0

statement ok
INSERT INTO geographies VALUES(''::GEOGRAPHY), (NULL::GEOGRAPHY), ('MULTIPOLYGON(((5 90,10 90,10 89,5 90)),((5 90,0 90,0 41,5 90)))')

query R
SELECT ST_EQUALS(g, 'LINESTRING(8.6 4.3, 4.0 7.0,8.9 11.4, 2.5 16.9)') FROM geographies
----
0
1
0
0
0
0
NULL
0
