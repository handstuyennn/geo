# name: test/sql/function/test_buffer.test
# description: ST_BUFFER test
# group: [function]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

#test with POINT
query I
SELECT ST_ASTEXT(ST_BUFFER('POINT(100 90)', 50))
----
POLYGON((150 90,149.0392640201615 80.24548389919359,146.19397662556435 70.86582838174552,141.57348061512727 62.22148834901989,135.35533905932738 54.64466094067263,127.77851165098011 48.42651938487274,119.1341716182545 43.80602337443566,109.75451610080641 40.960735979838475,100 40,90.24548389919359 40.960735979838475,80.86582838174552 43.80602337443566,72.2214883490199 48.42651938487273,64.64466094067262 54.64466094067262,58.426519384872734 62.22148834901989,53.80602337443566 70.8658283817455,50.960735979838475 80.24548389919357,50 90,50.960735979838475 99.75451610080641,53.80602337443566 109.13417161825448,58.42651938487273 117.7785116509801,64.64466094067262 125.35533905932738,72.22148834901989 131.57348061512727,80.86582838174549 136.19397662556432,90.24548389919357 139.0392640201615,99.99999999999999 140,109.75451610080641 139.0392640201615,119.1341716182545 136.19397662556435,127.7785116509801 131.57348061512727,135.35533905932738 125.35533905932738,141.57348061512727 117.77851165098011,146.19397662556432 109.13417161825453,149.0392640201615 99.75451610080644,150 90))

query I 
SELECT ST_ASTEXT(ST_BUFFER('010100000000000000000024400000000000004B40', 10))
----
POLYGON((20 54,19.807852804032304 52.04909677983872,19.238795325112868 50.1731656763491,18.314696123025453 48.44429766980398,17.071067811865476 46.928932188134524,15.555702330196024 45.68530387697455,13.826834323650898 44.76120467488713,11.950903220161283 44.19214719596769,10 44,8.049096779838719 44.19214719596769,6.173165676349103 44.76120467488713,4.44429766980398 45.685303876974544,2.928932188134525 46.928932188134524,1.685303876974547 48.44429766980398,0.761204674887132 50.1731656763491,0.192147195967696 52.04909677983871,0 54,0.192147195967696 55.95090322016129,0.761204674887132 57.8268343236509,1.685303876974546 59.55570233019602,2.928932188134523 61.071067811865476,4.444297669803978 62.314696123025456,6.173165676349097 63.23879532511286,8.049096779838713 63.8078528040323,9.999999999999998 64,11.950903220161283 63.80785280403231,13.8268343236509 63.23879532511287,15.555702330196018 62.314696123025456,17.071067811865476 61.071067811865476,18.314696123025453 59.55570233019602,19.238795325112864 57.82683432365091,19.8078528040323 55.95090322016129,20 54))

query I
SELECT ST_ASTEXT(ST_BUFFER('POINT(100 90)', 50, 'quad_segs=8'))
----
POLYGON((150 90,149.0392640201615 80.24548389919359,146.19397662556435 70.86582838174552,141.57348061512727 62.22148834901989,135.35533905932738 54.64466094067263,127.77851165098011 48.42651938487274,119.1341716182545 43.80602337443566,109.75451610080641 40.960735979838475,100 40,90.24548389919359 40.960735979838475,80.86582838174552 43.80602337443566,72.2214883490199 48.42651938487273,64.64466094067262 54.64466094067262,58.426519384872734 62.22148834901989,53.80602337443566 70.8658283817455,50.960735979838475 80.24548389919357,50 90,50.960735979838475 99.75451610080641,53.80602337443566 109.13417161825448,58.42651938487273 117.7785116509801,64.64466094067262 125.35533905932738,72.22148834901989 131.57348061512727,80.86582838174549 136.19397662556432,90.24548389919357 139.0392640201615,99.99999999999999 140,109.75451610080641 139.0392640201615,119.1341716182545 136.19397662556435,127.7785116509801 131.57348061512727,135.35533905932738 125.35533905932738,141.57348061512727 117.77851165098011,146.19397662556432 109.13417161825453,149.0392640201615 99.75451610080644,150 90))

query I
SELECT ST_ASTEXT(ST_BUFFER('POINT(100 90)', 50, 'join=bevel'))
----
POLYGON((150 90,149.0392640201615 80.24548389919359,146.19397662556435 70.86582838174552,141.57348061512727 62.22148834901989,135.35533905932738 54.64466094067263,127.77851165098011 48.42651938487274,119.1341716182545 43.80602337443566,109.75451610080641 40.960735979838475,100 40,90.24548389919359 40.960735979838475,80.86582838174552 43.80602337443566,72.2214883490199 48.42651938487273,64.64466094067262 54.64466094067262,58.426519384872734 62.22148834901989,53.80602337443566 70.8658283817455,50.960735979838475 80.24548389919357,50 90,50.960735979838475 99.75451610080641,53.80602337443566 109.13417161825448,58.42651938487273 117.7785116509801,64.64466094067262 125.35533905932738,72.22148834901989 131.57348061512727,80.86582838174549 136.19397662556432,90.24548389919357 139.0392640201615,99.99999999999999 140,109.75451610080641 139.0392640201615,119.1341716182545 136.19397662556435,127.7785116509801 131.57348061512727,135.35533905932738 125.35533905932738,141.57348061512727 117.77851165098011,146.19397662556432 109.13417161825453,149.0392640201615 99.75451610080644,150 90))

#test with LINESTRING
query I
SELECT ST_ASTEXT(ST_BUFFER('SRID=4326;LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)', 50))
----
POLYGON((-121.88498891973074 42.29192124306673,-121.89872573083314 47.21190857989333,-120.01335448408551 56.830586932233906,-120.0113544840855 56.8372469322339,-116.12107536928178 66.21076193944907,-110.4181685746231 74.60563592736585,-103.13758714243934 81.67600997623393,-94.57928245174034 87.1305930036271,-85.09584657472153 90.74466261391939,-75.07798589871736 92.3693233962783,-64.93842448326687 91.93764124020305,-55.09490031501969 89.46740094203369,-45.95295499475104 85.06037349229118,-37.88922590110835 78.8981232307466,-31.235929174262438 71.23452760949235,-26.267172802259033 62.38531774096501,-23.187663694790537 52.71507064802139,-22.124273999646576 42.62218912004199,-22.123273999646585 42.32012912004199,-23.051711585326643 32.56248587828815,-24.38325082658737 28.120098686587014,-24.236645515914496 28.076073067766096,-24.238645515914506 28.0694130677661,-24.829127585000123 26.63252915857625,-25.86593126528701 23.173462202912127,-27.57555143594623 19.94935883750172,-27.964300939947755 19.003372606505213,-28.524206517878582 18.160328680532754,-30.4577841554594 14.513873008333476,-33.09320227871887 11.280839931366938,-33.38706569269266 10.838372886956208,-33.75768043891917 10.465682802450916,-36.65080792441523 6.916501450946292,-40.21812254710091 3.969064036590287,-40.298545965822726 3.888190269356755,-40.39221026172116 3.825226809509612,-44.207008141801296 0.673310259045913,-52.83600427082934 -3.97577823108491,-62.206188829457595 -6.85210215600928,-71.95747087995802 -7.845126000353417,-81.71511412171185 -6.916688414673359,-91.10413779708787 -4.102468734712993,-99.76372699166652 0.48938415545939,-103.62069839065073 3.633407765423104,-103.7376271130438 3.71106569269265,-103.83611620049166 3.809006340078057,-107.36109854905372 6.682407924415237,-110.28843976668183 10.225399908018373,-110.68780973064324 10.622545965822713,-110.99873520809042 11.085077980306618,-113.60428974095412 14.238608141801311,-115.56509506484853 17.877984244359958,-116.15608362600614 18.75713744844437,-116.559927273217 19.724454427336042,-118.25337823108491 22.867604270829325,-119.31218263228152 26.316865518747008,-119.93230609997696 27.802232351811917,-120.24739791952013 29.3635111929496,-121.12970215600929 32.237788829457585,-121.43753388412323 35.26063064944887,-121.87135904061101 37.41023275133657,-121.8774176675161 39.58019544714836,-122.12272600035342 41.989070879958014,-122.12372600035341 42.29113087995801,-121.88498891973074 42.29192124306673))

query I 
SELECT ST_ASTEXT(ST_BUFFER('010200000006000000e44a3d0b42ca51c06ec328081e21454027bf45274bca51c0f67b629d2a214540957cec2e50ca51c07099d3653121454047ded1e65dcb51c0781c510ef83145404871a7835dcb51c0ebdaee75f53145406285c7c15ecb51c0ed88fc0df5314540', 10))
----
POLYGON((-81.14562027300856 42.93014265507729,-81.15062355595438 43.124498931209736,-81.01927607240361 43.87750828609041,-80.91259581033604 44.67742797616226,-80.84541427315366 44.87425034579644,-80.81020976730693 45.07607623175866,-80.53610914882701 45.78042442372353,-80.27934342547228 46.53267333363341,-80.16985299994931 46.72158193620438,-80.0917610353359 46.92225253077465,-79.78868106281801 47.39556578303108,-79.86552081812536 47.342164199753476,-79.55428764721368 47.78364366462479,-79.29631839340968 48.22872926009699,-79.145229481055 48.40042980721473,-79.02347313563087 48.59057398387143,-78.88254963806327 48.73649369646667,-78.76071737931943 48.90931088120548,-78.35438943768122 49.29915669599613,-78.00129781484364 49.70041727745813,-77.81138133302528 49.84563854392043,-77.64727140613824 50.01556672324264,-77.50601726858059 50.11311583002789,-77.37711787704771 50.236786597328695,-76.88445202697505 50.55442298672816,-76.44404860435252 50.89118124054178,-76.22014274858716 51.00113166469374,-76.01716537238708 51.14130640285211,-75.88818515683448 51.196745996255004,-75.76559089159021 51.27578618093095,-75.19978028111703 51.50218727890977,-74.68441497578007 51.75526075803478,-74.43333172246179 51.82208595647191,-74.19712912448216 51.92361296925131,-74.09042434735709 51.94608033570935,-73.98538484685757 51.98811040337519,-73.36376346652789 52.1067489517145,-72.79001866265847 52.259449738661225,-72.87168538666448 52.2026935407065,-72.25859063122222 52.331784523464265,-72.18096218221241 52.33249058767728,-72.10194971876608 52.347570384255405,-70.95744959618585 52.34361896216091,-70.27762852410217 52.34980222791429,-70.2322969942697 52.34111535035994,-70.18453074111223 52.340950435892594,-68.77778197506507 52.062386749770425,-68.33198636440645 51.9769589713926,-68.31844970089756 51.9714300028834,-68.30362257729762 51.968493943293886,-66.52837755628246 51.24389441600701,-66.51371480864204 51.234296928682284,-66.49802156954155 51.227887119888784,-66.09184391431593 50.95816174172711,-64.92406325999347 50.19379204085201,-64.88809648682265 50.15880405694406,-64.84770873907738 50.13198426419194,-64.36190647753419 49.646933628922376,-63.54966293498512 48.85679424496739,-63.50239368090046 48.78875065812848,-63.44581498603064 48.732259501001806,-63.039119282383986 48.12187210512148,-62.45570695016457 47.2820562785556,-62.40910571966688 47.17631911681087,-62.347358128517335 47.083645525657325,-62.06595513240721 46.397718020651496,-61.876508597201244 45.96786802053088,-61.863750235924826 45.94308996936821,-61.860331238698585 45.931161951735476,-61.68241502789027 45.527474002762084,-61.649610137538154 45.38286570031432,-61.59544749594536 45.2508427790028,-61.59542385299395 45.2507635782805,-61.43868228023096 44.46013525045031,-61.323597299841566 44.058632826052246,-61.30882555594964 43.88064211977712,-61.25821755004913 43.657555325552664,-61.24144824878963 43.52628575947726,-61.25324835440129 43.524778330666365,-61.22887305811581 43.4018256295875,-61.22520363130934 42.87304778726603,-61.161462601879634 42.10500638809879,-61.21652329458465 41.62217947295247,-61.21579305304519 41.5169489925605,-61.24931486713932 41.3346303514005,-61.383576887555506 40.157287423912074,-61.98140442943378 38.290325680992396,-62.93197105034564 36.57586745211596,-64.19874700813332 35.07979840553923,-65.73305081315522 33.85961163571697,-67.47592003063178 32.96219823592483,-69.36037717394775 32.42204529984157,-71.3140036119012 32.25991060187964,-73.26172257608793 32.48202488755551,-75.1286843190076 33.079852429433785,-76.74562917091907 33.97635359708812,-76.75139021569714 33.96780943889103,-76.75169721569713 33.968016438891034,-76.79239244504399 34.00228109226939,-76.84314254788404 34.03041905034564,-76.84369854788405 34.03080305034564,-76.8372891550631 34.04008331703442,-78.37911625717749 35.33827408954572,-79.67984274541351 37.0217851137305,-80.59500451487537 38.94235213975848,-80.87985177995849 40.15058904416151,-81.04681726999583 40.77793081659034,-81.0538999387547 40.888849278254426,-81.08318044001084 41.0130484071692,-81.09964274127034 41.1441109732446,-81.11953023476369 41.91665556423281,-81.1717400139827 42.734289226337566,-81.14562027300856 42.93014265507729))

query I
SELECT ST_ASTEXT(ST_BUFFER('SRID=4326;LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)', 50, 'quad_segs=2'))
----
POLYGON((-120.0113544840855 56.8372469322339,-98.99718594659981 84.62100366949721,-64.93842448326687 91.93764124020305,-34.36763455185338 75.23556889193843,-22.124273999646576 42.62218912004199,-22.123273999646585 42.32012912004199,-27.558809101318367 29.07371979011488,-24.236645515914496 28.076073067766096,-24.238645515914506 28.0694130677661,-31.746093077091306 18.86930081641101,-36.65080792441523 6.916501450946292,-44.0108344266051 3.839292783737402,-48.43313744844437 -1.580083626006122,-59.70390195223073 -2.721939487719954,-71.95747087995802 -7.845126000353417,-79.54419920471322 -4.731985896575468,-86.50658693223392 -5.437354484085496,-95.28775850969842 1.728230385142692,-107.36109854905372 6.682407924415237,-110.46934001411238 14.116658257132194,-116.15608362600614 18.75713744844437,-117.35427342430654 30.583949833690607,-122.12272600035342 41.989070879958014,-122.12372600035341 42.29113087995801,-118.54154468365384 42.30299005136987,-120.01335448408551 56.830586932233906,-120.0113544840855 56.8372469322339))

query I
SELECT ST_ASTEXT(ST_BUFFER('SRID=4326;LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)', 50, 'join=bevel'))
----
POLYGON((-121.88498891973074 42.29192124306673,-121.89872573083314 47.21190857989333,-120.01335448408551 56.830586932233906,-120.0113544840855 56.8372469322339,-22.124273999646576 42.62218912004199,-22.123273999646585 42.32012912004199,-23.051711585326643 32.56248587828815,-24.38325082658737 28.120098686587014,-24.236645515914496 28.076073067766096,-24.238645515914506 28.0694130677661,-24.829127585000123 26.63252915857625,-25.86593126528701 23.173462202912127,-27.57555143594623 19.94935883750172,-27.964300939947755 19.003372606505213,-28.524206517878582 18.160328680532754,-30.4577841554594 14.513873008333476,-33.09320227871887 11.280839931366938,-33.38706569269266 10.838372886956208,-33.75768043891917 10.465682802450916,-36.65080792441523 6.916501450946292,-40.21812254710091 3.969064036590287,-40.298545965822726 3.888190269356755,-40.39221026172116 3.825226809509612,-44.207008141801296 0.673310259045913,-52.83600427082934 -3.97577823108491,-62.206188829457595 -6.85210215600928,-71.95747087995802 -7.845126000353417,-81.71511412171185 -6.916688414673359,-91.10413779708787 -4.102468734712993,-99.76372699166652 0.48938415545939,-103.62069839065073 3.633407765423104,-103.7376271130438 3.71106569269265,-103.83611620049166 3.809006340078057,-107.36109854905372 6.682407924415237,-110.28843976668183 10.225399908018373,-110.68780973064324 10.622545965822713,-110.99873520809042 11.085077980306618,-113.60428974095412 14.238608141801311,-115.56509506484853 17.877984244359958,-116.15608362600614 18.75713744844437,-116.559927273217 19.724454427336042,-118.25337823108491 22.867604270829325,-119.31218263228152 26.316865518747008,-119.93230609997696 27.802232351811917,-120.24739791952013 29.3635111929496,-121.12970215600929 32.237788829457585,-121.43753388412323 35.26063064944887,-121.87135904061101 37.41023275133657,-121.8774176675161 39.58019544714836,-122.12272600035342 41.989070879958014,-122.12372600035341 42.29113087995801,-121.88498891973074 42.29192124306673))

#test with POLYGON
query I
SELECT ST_ASTEXT(ST_BUFFER('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 50))
----
POLYGON((-106.49762216022657 7.315647808511525,-110.8181583453246 11.887768884891354,-116.16373114054872 20.54199402048672,-119.64718860956526 30.09899591795243,-121.12435635399427 40.16322647281499,-120.53409690545736 50.318144246486185,-117.90084010173435 60.14345441015312,-113.33357197719869 69.23250403512554,-107.02132401564259 77.20911276806719,-107.02072801564262 77.20972576806719,-100.28590850629337 83.00430477700596,-92.63184064758781 87.51542270149824,-84.3001937935245 90.60064561297838,-75.5540311609621 92.16256075763717,-66.66950387795391 92.1518522643616,-66.66822087795391 92.15173626436159,-56.635413911303274 90.19553802838244,-47.210080554893736 86.23990681591135,-38.78613914630537 80.45016258035209,-31.71565627778091 73.06827940771764,-26.29413267615282 64.40277255551845,-22.74815317227508 54.81580449848391,-21.225916911837373 44.70804886550928,-21.791043583867257 34.50194485795175,-24.41991452674818 24.6240420069313,-29.00265983642757 15.487173145273445,-35.34775022203808 7.473200649254075,-35.34889922203808 7.472020649254077,-42.93192874153705 1.092099915548964,-51.62427957681203 -3.666971655508519,-61.08449628065921 -6.618246833834689,-70.94095987606393 -7.645792771695483,-80.80648590066436 -6.709245111463886,-90.2935338991258 -3.845393590026049,-99.02943089973473 0.833263146335874,-103.67818139022576 4.671749216922835,-103.83135041837585 4.494190216139721,-103.83171441837584 4.494504216139717,-105.13916386976302 5.878086470029108,-106.67101086218777 7.142936746403443,-106.67137686218777 7.143305746403442,-106.49762216022657 7.315647808511525))

query I 
SELECT ST_ASTEXT(ST_BUFFER('010300000001000000050000004a5349305fcb51c01c21e402f53145406ba94a2e5fcb51c048dc8411f8314540775e168b5dcb51c0988b2b0ff83145406a0561835dcb51c0bde47c00f53145404a5349305fcb51c01c21e402f5314540', 10))
----
POLYGON((-71.20570086796307 32.390328896224105,-73.15887129921688 32.588509187402224,-75.0356838298276 33.16446481614305,-76.76380328661874 34.09599758765225,-78.27662535075828 35.347204830113796,-79.51584358822048 36.869863137573724,-80.43369666730689 38.60528697241847,-80.99480915208909 40.48659049411751,-81.17755492482955 42.441265439954066,-81.17755444923705 42.441358736464764,-80.97603871557145 44.388445071108926,-80.39907416860952 46.258970584707136,-79.46876866922031 47.98126134508386,-78.22076923359313 49.48932341083151,-76.7028961273453 50.725371556658516,-74.97331051068414 51.6420434609469,-73.09828584594908 52.20421451330371,-71.14966846170962 52.39034370314945,-71.14956851562353 52.390343423140244,-69.22678377026051 52.19825587169415,-67.37684189822922 51.63994245207518,-65.66881970691378 50.73625058069684,-64.16649472451716 49.52092410123204,-62.92596374792059 48.03934328989381,-61.993548188958655 46.34683035646406,-61.40406443345522 44.50658371364173,-61.179523797793046 42.58731814906821,-61.17952195996964 42.58722484607521,-61.33819242926971 40.605240006563264,-61.88585730687976 38.693826026360256,-62.800864989247216 36.92854951456624,-64.04704119462404 35.379199622825936,-65.57511909167135 34.1070289729371,-67.32468703418557 33.16233207106344,-69.22657689941815 32.582456944498496,-71.20559860846107 32.39032860973259,-71.20570086796307 32.390328896224105))

query I
SELECT ST_ASTEXT(ST_BUFFER('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 50, 'quad_segs=2'))
----
POLYGON((-105.620987956452 8.185154904939433,-121.12435635399427 40.16322647281499,-107.02132401564259 77.20911276806719,-107.02072801564262 77.20972576806719,-66.66950387795391 92.1518522643616,-66.66822087795391 92.15173626436159,-33.90254805130624 75.68800573098835,-21.18172844024639 41.295790226875816,-35.34775022203808 7.473200649254075,-35.34889922203808 7.472020649254077,-70.94095987606393 -7.645792771695483,-102.89474678593145 5.579934554373069,-103.83135041837585 4.494190216139721,-103.83171441837584 4.494504216139717,-104.7252650345259 6.337589203870238,-106.67101086218777 7.142936746403443,-106.67137686218777 7.143305746403442,-105.620987956452 8.185154904939433))

query I
SELECT ST_ASTEXT(ST_BUFFER('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 50, 'join=bevel'))
----
POLYGON((-104.06145629427222 9.732007447916445,-107.02132401564259 77.20911276806719,-107.02072801564262 77.20972576806719,-66.66950387795391 92.1518522643616,-66.66822087795391 92.15173626436159,-35.34775022203808 7.473200649254075,-35.34889922203808 7.472020649254077,-101.52596410787417 7.166676257577778,-103.83135041837585 4.494190216139721,-103.83171441837584 4.494504216139717,-103.94843833600972 7.155498836505725,-106.67101086218777 7.142936746403443,-106.67137686218777 7.143305746403442,-104.06145629427222 9.732007447916445))

#test with MULTIPOINT
query I
SELECT ST_ASTEXT(ST_BUFFER('MULTIPOINT(100 90, 50 74)', 50))
----
POLYGON((62.14803923917954 122.3131967139986,64.64466094067262 125.35533905932738,72.22148834901989 131.57348061512727,80.86582838174549 136.19397662556432,90.24548389919357 139.0392640201615,99.99999999999999 140,109.75451610080641 139.0392640201615,119.1341716182545 136.19397662556435,127.7785116509801 131.57348061512727,135.35533905932738 125.35533905932738,141.57348061512727 117.77851165098011,146.19397662556432 109.13417161825453,149.0392640201615 99.75451610080644,150 90,149.0392640201615 80.24548389919359,146.19397662556435 70.86582838174552,141.57348061512727 62.22148834901989,135.35533905932738 54.64466094067263,127.77851165098011 48.42651938487274,119.1341716182545 43.80602337443566,109.75451610080641 40.960735979838475,100 40,90.24548389919359 40.960735979838475,87.85196076082046 41.6868032860014,85.35533905932738 38.64466094067263,77.77851165098011 32.42651938487274,69.1341716182545 27.80602337443566,59.75451610080641 24.960735979838475,50 24,40.24548389919359 24.960735979838475,30.865828381745512 27.80602337443566,22.221488349019904 32.42651938487273,14.64466094067263 38.64466094067262,8.426519384872734 46.22148834901989,3.806023374435661 54.86582838174551,0.960735979838475 64.24548389919357,0 74,0.960735979838475 83.75451610080641,3.806023374435661 93.13417161825448,8.426519384872726 101.7785116509801,14.644660940672615 109.35533905932738,22.221488349019893 115.57348061512727,30.865828381745484 120.19397662556432,40.245483899193566 123.03926402016151,49.99999999999999 124,59.75451610080641 123.03926402016153,62.14803923917954 122.3131967139986))

query I 
SELECT ST_ASTEXT(ST_BUFFER('0104000000060000000101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f', 10))
----
POLYGON((-9.1 0.899999999999999,-8.907852804032304 2.850903220161284,-8.338795325112867 4.726834323650896,-7.414696123025454 6.45570233019602,-6.171067811865477 7.971067811865475,-4.655702330196021 9.214696123025453,-2.926834323650903 10.138795325112865,-1.050903220161286 10.707852804032303,0.899999999999998 10.9,2.850903220161283 10.707852804032305,4.7268343236509 10.138795325112866,6.455702330196019 9.214696123025456,7.971067811865475 7.971067811865478,9.214696123025453 6.455702330196022,10.138795325112865 4.726834323650904,10.707852804032303 2.850903220161287,10.9 0.9,10.707852804032305 -1.050903220161282,10.138795325112868 -2.926834323650898,9.214696123025453 -4.655702330196021,7.971067811865476 -6.171067811865474,6.455702330196023 -7.41469612302545,4.726834323650898 -8.338795325112867,2.850903220161283 -8.907852804032304,0.900000000000001 -9.1,-1.050903220161282 -8.907852804032304,-2.926834323650897 -8.338795325112867,-4.65570233019602 -7.414696123025454,-6.171067811865474 -6.171067811865475,-7.414696123025452 -4.655702330196021,-8.338795325112867 -2.926834323650898,-8.907852804032304 -1.050903220161286,-9.1 0.899999999999999))

query I
SELECT ST_ASTEXT(ST_BUFFER('MULTIPOINT(100 10 30, 50 74 1000)', 50, 'quad_segs=2'))
----
POLYGON((57 26.899494936611667,50 24,14.64466094067263 38.64466094067262,0 74,14.644660940672615 109.35533905932738,49.99999999999999 124,85.35533905932738 109.35533905932738,100 74,93 57.10050506338834,99.99999999999999 60,135.35533905932738 45.355339059327385,150 10,135.35533905932738 -25.35533905932737,100 -40,64.64466094067262 -25.355339059327378,50 9.999999999999995,57 26.899494936611667))

query I
SELECT ST_ASTEXT(ST_BUFFER('MULTIPOINT(100 10, 50 74)', 50, 'join=bevel'))
----
POLYGON((52.31783962962133 24.228287277878255,50 24,40.24548389919359 24.960735979838475,30.865828381745512 27.80602337443566,22.221488349019904 32.42651938487273,14.64466094067263 38.64466094067262,8.426519384872734 46.22148834901989,3.806023374435661 54.86582838174551,0.960735979838475 64.24548389919357,0 74,0.960735979838475 83.75451610080641,3.806023374435661 93.13417161825448,8.426519384872726 101.7785116509801,14.644660940672615 109.35533905932738,22.221488349019893 115.57348061512727,30.865828381745484 120.19397662556432,40.245483899193566 123.03926402016151,49.99999999999999 124,59.75451610080641 123.03926402016153,69.1341716182545 120.19397662556433,77.7785116509801 115.57348061512728,85.35533905932738 109.35533905932738,91.57348061512727 101.77851165098011,96.19397662556432 93.13417161825453,99.03926402016151 83.75451610080644,100 74,99.03926402016153 64.24548389919359,97.68216037037867 59.77171272212175,99.99999999999999 60,109.75451610080641 59.039264020161525,119.1341716182545 56.19397662556433,127.7785116509801 51.57348061512728,135.35533905932738 45.355339059327385,141.57348061512727 37.77851165098011,146.19397662556432 29.13417161825452,149.0392640201615 19.754516100806434,150 10,149.0392640201615 0.245483899193587,146.19397662556435 -9.134171618254488,141.57348061512727 -17.778511650980107,135.35533905932738 -25.35533905932737,127.77851165098011 -31.57348061512726,119.1341716182545 -36.19397662556434,109.75451610080641 -39.039264020161525,100 -40,90.24548389919359 -39.039264020161525,80.86582838174552 -36.19397662556434,72.2214883490199 -31.573480615127274,64.64466094067262 -25.355339059327378,58.426519384872734 -17.778511650980107,53.80602337443566 -9.134171618254491,50.960735979838475 0.245483899193571,50 9.999999999999995,50.960735979838475 19.75451610080642,52.31783962962133 24.228287277878255))

#test with MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_BUFFER('MULTILINESTRING((-118.584 38.374 20,-118.583 38.5 30),(-71.05957 42.3589 75, -71.061 43 90))', 50))
----
POLYGON((-168.5814253704312 38.89681289976723,-167.5433052902626 48.643397156982616,-164.62366813504477 58.00017634993779,-159.9347139233013 66.60757470158975,-153.65663653579372 74.13481472036912,-146.03069896573754 80.29262879367904,-137.349961717275 84.8443755800241,-127.94802065465096 87.6151340030541,-118.18618710023277 88.49842537043119,-108.4396028430174 87.46030529026261,-99.08282365006221 84.54066813504477,-98.97074864977581 84.47961431562636,-98.93217368086077 84.51141623278221,-90.29816133355116 89.15118225817108,-80.92487566451754 92.01738423125961,-71.17252678542171 92.99987561760662,-61.41589199450707 92.0608998242223,-52.029913295204636 89.23654116426272,-43.37528858521111 84.63533815711153,-35.78461023856207 78.43411245394918,-29.549583767217804 70.87117368086076,-24.909817741828938 62.23716133355116,-22.043615768740395 52.86387566451755,-21.061124382393388 43.11152678542169,-21.059694382393374 42.47042678542169,-21.998670175777697 32.71379199450704,-24.823028835737283 23.327813295204606,-29.424231842888474 14.673188585211076,-35.62545754605082 7.082510238562051,-43.18839631913923 0.847483767217788,-51.82240866644885 -3.792282258171078,-61.19569433548247 -6.658484231259621,-70.9480432145783 -7.640975617606628,-80.70467800549295 -6.701999824222298,-90.09065670479538 -3.877641164262712,-91.06393983346547 -3.360198362465046,-91.13630103426246 -3.418628793679026,-99.81703828272501 -7.970375580024104,-109.21897934534904 -10.7411340030541,-118.98081289976723 -11.624425370431197,-128.72739715698262 -10.586305290262608,-138.0841763499378 -7.666668135044766,-146.69157470158976 -2.977713923301323,-154.21881472036912 3.300363464206278,-160.37662879367903 10.926301034262458,-164.92837558002412 19.60703828272501,-167.6991340030541 29.00897934534902,-168.58242537043122 38.77081289976723,-168.5814253704312 38.89681289976723))

query I 
SELECT ST_ASTEXT(ST_BUFFER('01050000C00200000001020000C004000000000000000000000000000000000000000000000000000000000000000000F03F00000000000000000000000000001440000000000000000000000000000000400000000000001440000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000000000000000000104001020000C004000000000000000000F03F000000000000F03F0000000000000000000000000000F03F0000000000000840000000000000F03F0000000000000000000000000000F03F000000000000F03F00000000000008400000000000000000000000000000F03F000000000000F03F000000000000F03F0000000000000000000000000000F03F', 10))
----
POLYGON((0 -10,-1.950903220161287 -9.807852804032303,-3.826834323650903 -9.238795325112864,-5.555702330196022 -8.314696123025453,-7.071067811865477 -7.071067811865475,-8.314696123025454 -5.55570233019602,-9.238795325112868 -3.826834323650897,-9.807852804032304 -1.950903220161284,-10 0,-10 5,-9.807852804032304 6.950903220161286,-9.238795325112868 8.826834323650898,-8.314696123025453 10.555702330196022,-7.071067811865475 12.071067811865476,-5.55570233019602 13.314696123025454,-3.826834323650897 14.238795325112868,-1.950903220161282 14.807852804032304,6.123233995736766e-16 15,1.950903220161283 14.807852804032304,3.826834323650898 14.238795325112868,5.555702330196022 13.314696123025453,7.071067811865475 12.071067811865476,12.071067811865476 7.071067811865475,13.314696123025453 5.555702330196022,14.238795325112868 3.826834323650898,14.807852804032304 1.950903220161282,15 0,14.807852804032304 -1.950903220161282,14.238795325112868 -3.826834323650898,13.314696123025453 -5.555702330196022,12.071067811865476 -7.071067811865475,10.555702330196024 -8.31469612302545,8.826834323650898 -9.238795325112868,6.950903220161285 -9.807852804032304,5 -10,0 -10))

query I
SELECT ST_ASTEXT(ST_BUFFER('MULTILINESTRING((-118.584 38.374 20,-118.583 38.5 30),(-71.05957 42.3589 75, -71.061 43 90))', 50, 'quad_segs=2'))
----
POLYGON((-168.5814253704312 38.89681289976723,-153.65663653579372 74.13481472036912,-118.18618710023277 88.49842537043119,-100.22363782360122 80.89052364404105,-71.17252678542171 92.99987561760662,-35.78461023856207 78.43411245394918,-21.061124382393388 43.11152678542169,-21.059694382393374 42.47042678542169,-35.62545754605082 7.082510238562051,-70.9480432145783 -7.640975617606628,-89.89023574075038 0.155682593997216,-118.98081289976723 -11.624425370431197,-154.21881472036912 3.300363464206278,-168.58242537043122 38.77081289976723,-168.5814253704312 38.89681289976723))

query I
SELECT ST_ASTEXT(ST_BUFFER('MULTILINESTRING((-118.584 38.374 20,-118.583 38.5 30),(-71.05957 42.3589 75, -71.061 43 90))', 50, 'join=bevel'))
----
POLYGON((-168.5814253704312 38.89681289976723,-167.5433052902626 48.643397156982616,-164.62366813504477 58.00017634993779,-159.9347139233013 66.60757470158975,-153.65663653579372 74.13481472036912,-146.03069896573754 80.29262879367904,-137.349961717275 84.8443755800241,-127.94802065465096 87.6151340030541,-118.18618710023277 88.49842537043119,-108.4396028430174 87.46030529026261,-99.08282365006221 84.54066813504477,-98.97074864977581 84.47961431562636,-98.93217368086077 84.51141623278221,-90.29816133355116 89.15118225817108,-80.92487566451754 92.01738423125961,-71.17252678542171 92.99987561760662,-61.41589199450707 92.0608998242223,-52.029913295204636 89.23654116426272,-43.37528858521111 84.63533815711153,-35.78461023856207 78.43411245394918,-29.549583767217804 70.87117368086076,-24.909817741828938 62.23716133355116,-22.043615768740395 52.86387566451755,-21.061124382393388 43.11152678542169,-21.059694382393374 42.47042678542169,-21.998670175777697 32.71379199450704,-24.823028835737283 23.327813295204606,-29.424231842888474 14.673188585211076,-35.62545754605082 7.082510238562051,-43.18839631913923 0.847483767217788,-51.82240866644885 -3.792282258171078,-61.19569433548247 -6.658484231259621,-70.9480432145783 -7.640975617606628,-80.70467800549295 -6.701999824222298,-90.09065670479538 -3.877641164262712,-91.06393983346547 -3.360198362465046,-91.13630103426246 -3.418628793679026,-99.81703828272501 -7.970375580024104,-109.21897934534904 -10.7411340030541,-118.98081289976723 -11.624425370431197,-128.72739715698262 -10.586305290262608,-138.0841763499378 -7.666668135044766,-146.69157470158976 -2.977713923301323,-154.21881472036912 3.300363464206278,-160.37662879367903 10.926301034262458,-164.92837558002412 19.60703828272501,-167.6991340030541 29.00897934534902,-168.58242537043122 38.77081289976723,-168.5814253704312 38.89681289976723))

#test with MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_BUFFER('MULTIPOLYGON(((26 15,26 20,126 20,126 15,101 10,26 15),(51 10,101 10,76 15,51 10)),((151 10,151 20,176 15,151 10)))', 50))
----
POLYGON((22.6740494738113 -34.88925789283045,13.407244290606661 -33.388247577728436,4.584342360960619 -30.18151843273369,-3.483642986290764 -25.38210985395572,-10.51230974828514 -19.15920427710929,-16.253892613296408 -11.732163380916539,-20.50599685747129 -3.362795437864872,-23.118732897304895 5.653873606503183,-24 15,-24 20,-23.039264020161525 29.754516100806427,-20.19397662556434 39.13417161825449,-15.573480615127266 47.77851165098011,-9.35533905932737 55.35533905932738,-1.778511650980096 61.57348061512727,6.865828381745512 66.19397662556435,16.24548389919359 69.03926402016153,26 70,126 70,135.75451610080643 69.03926402016153,138.5031136572106 68.20548606685507,141.28538401342817 69.0471837747433,151.04648972665782 69.99997838704849,160.8058067569092 69.02903378454602,185.8058067569092 64.02903378454602,195.17558087395426 61.17680259769443,203.80956578782946 56.552714119445746,211.37646551737416 50.33419996968995,217.5859293733933 42.759871724327965,222.19969305021792 34.120365113293374,225.04072110252304 24.747187991649284,226 15,225.04072110252304 5.252812008350716,222.19969305021792 -4.120365113293364,217.5859293733933 -12.759871724327962,211.37646551737416 -20.334199969689948,203.80956578782946 -26.552714119445746,195.1755808739543 -31.176802597694426,185.8058067569092 -34.02903378454601,160.8058067569092 -39.02903378454601,151.04648972665785 -39.999978387048486,141.28538401342814 -39.0471837747433,131.89804621636637 -36.20730853066347,129.99434916391763 -35.191325303144325,110.8058067569092 -39.02903378454601,97.67404947381131 -39.88925789283045,22.6740494738113 -34.88925789283045))

query I 
SELECT ST_ASTEXT(ST_BUFFER('0106000000030000000103000000020000000500000000000000000010400000000000000000000000000000000000000000000010C000000000000010C00000000000000000000000000000000000000000000010400000000000001040000000000000000005000000000000000000004000000000000000000000000000000000000000000000004000000000000000C00000000000000000000000000000000000000000000000C0000000000000004000000000000000000103000000020000000500000000000000000038400000000000000000000000000000344000000000000010C000000000000030400000000000000000000000000000344000000000000010400000000000003840000000000000000005000000000000000000364000000000000000000000000000003440000000000000004000000000000032400000000000000000000000000000344000000000000000C0000000000000364000000000000000000103000000020000000500000000000000000046400000000000000000000000000000444000000000000010C000000000000042400000000000000000000000000000444000000000000010400000000000004640000000000000000005000000000000000000454000000000000000000000000000004440000000000000004000000000000043400000000000000000000000000000444000000000000000C000000000000045400000000000000000', 10))
----
POLYGON((10 -8.142135623730951,7.071067811865475 -11.071067811865476,5.555702330196022 -12.314696123025453,3.826834323650898 -13.238795325112868,1.950903220161281 -13.807852804032304,6.123233995736766e-16 -14,-1.950903220161284 -13.807852804032304,-3.826834323650897 -13.238795325112868,-5.555702330196023 -12.31469612302545,-7.071067811865475 -11.071067811865476,-11.071067811865476 -7.071067811865475,-12.314696123025454 -5.55570233019602,-13.238795325112868 -3.826834323650897,-13.807852804032304 -1.950903220161284,-14 1.224646799147353e-15,-13.807852804032304 1.950903220161286,-13.238795325112868 3.826834323650898,-12.314696123025453 5.555702330196022,-11.071067811865476 7.071067811865475,-7.071067811865475 11.071067811865476,-5.55570233019602 12.314696123025454,-3.826834323650897 13.238795325112868,-1.950903220161282 13.807852804032304,6.123233995736766e-16 14,1.950903220161283 13.807852804032304,3.826834323650898 13.238795325112868,5.555702330196023 12.31469612302545,7.071067811865475 11.071067811865476,10 8.142135623730951,12.928932188134524 11.071067811865476,14.44429766980398 12.314696123025454,16.173165676349104 13.238795325112868,18.049096779838717 13.807852804032304,20 14,21.950903220161283 13.807852804032304,23.8268343236509 13.238795325112868,25.555702330196024 12.31469612302545,27.071067811865476 11.071067811865476,30 8.142135623730951,32.928932188134524 11.071067811865476,34.44429766980398 12.314696123025454,36.1731656763491 13.238795325112868,38.04909677983872 13.807852804032304,40 14,41.95090322016128 13.807852804032304,43.8268343236509 13.238795325112868,45.55570233019602 12.31469612302545,47.071067811865476 11.071067811865476,51.071067811865476 7.071067811865475,52.314696123025456 5.555702330196022,53.23879532511287 3.826834323650898,53.80785280403231 1.950903220161282,54 0,53.80785280403231 -1.950903220161282,53.23879532511287 -3.826834323650898,52.314696123025456 -5.555702330196022,51.071067811865476 -7.071067811865475,47.071067811865476 -11.071067811865476,45.55570233019602 -12.31469612302545,43.8268343236509 -13.238795325112868,41.95090322016128 -13.807852804032304,40 -14,38.04909677983872 -13.807852804032304,36.1731656763491 -13.238795325112868,34.44429766980398 -12.314696123025454,32.928932188134524 -11.071067811865476,30 -8.142135623730951,27.071067811865476 -11.071067811865476,25.555702330196024 -12.31469612302545,23.8268343236509 -13.238795325112868,21.950903220161283 -13.807852804032304,20 -14,18.049096779838717 -13.807852804032304,16.173165676349104 -13.238795325112868,14.44429766980398 -12.314696123025454,12.928932188134524 -11.071067811865476,10 -8.142135623730951))

query I
SELECT ST_ASTEXT(ST_BUFFER('MULTIPOLYGON(((26 15,26 20,126 20,126 15,101 10,26 15),(51 10,101 10,76 15,51 10)),((151 10,151 20,176 15,151 10)))', 50, 'quad_segs=2'))
----
POLYGON((22.6740494738113 -34.88925789283045,-10.51230974828514 -19.15920427710929,-24 15,-24 20,-9.35533905932737 55.35533905932738,26 70,126 70,140.5516413390163 63.97251280259046,160.8058067569092 69.02903378454602,185.8058067569092 64.02903378454602,220.85134505682163 37.098797401531186,220.85134505682163 -7.098797401531183,185.8058067569092 -34.02903378454601,160.8058067569092 -39.02903378454601,137.26603353159626 -33.152249687625485,135.8058067569092 -34.02903378454601,110.8058067569092 -39.02903378454601,97.67404947381131 -39.88925789283045,22.6740494738113 -34.88925789283045))

query I
SELECT ST_ASTEXT(ST_BUFFER('MULTIPOLYGON(((26 12,26 20,126 20,126 12,101 10,26 12),(51 15,101 15,76 17,51 15)),((151 10,151 20,176 17,151 10)))', 50, 'join=bevel'))
----
POLYGON((24.667140488050972 -37.98223169808854,-24 12,-24 20,26 70,126 70,140.7419578003543 55.258042199645715,156.95726103092153 69.6438419243461,181.95726103092153 66.6438419243461,189.48149627599855 -31.14820098570908,164.48149627599855 -38.14820098570908,144.02630217031208 -22.633746305556038,129.9872611141445 -37.84076392680625,104.9872611141445 -39.84076392680625,99.66714048805098 -39.98223169808854,24.667140488050972 -37.98223169808854))

#test with COLLECTION
query I
SELECT ST_ASTEXT(ST_BUFFER('GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', 50))
----
POLYGON((-120.8272918553238 45.71466239846067,-120.83867691427687 46.77878996172944,-120.58061499264768 48.115848004373305,-120.15903275674597 52.2195859292584,-119.16641203824692 55.443048476937605,-118.93390143841754 56.64772123740988,-118.39128320137334 57.960222185608764,-117.27440057594612 61.587216107982435,-115.64136567146788 64.61180357205536,-115.09379185166006 65.93629122956864,-114.25393467839841 67.18150148689874,-112.61766180554484 70.21208607848574,-110.41535810348921 72.87274885228246,-109.47352540663559 74.26915263634068,-108.33278932117268 75.38875662532882,-106.36777230495952 77.76274692468465,-103.71351524400916 79.92245881019761,-102.30021476413944 81.30957794762622,-100.87227228312604 82.23431710098886,-98.76491182271923 83.94903098471912,-95.81087743615565 85.51208917364244,-93.86373046370282 86.77306646559944,-92.18514791178609 87.43055913108921,-90.1012540234232 88.5332028314701,-87.01932178306238 89.45398823617126,-84.50498737403736 90.43884086116417,-82.63712363473341 90.7632526134495,-80.70973841766305 91.33909531170018,-77.67427845292428 91.62520269464302,-74.60216846308316 92.15876869522774,-72.62897728310841 92.10074772920872,-70.95127568334556 92.25887955095669,-68.12196263388854 91.96822060945293,-64.5554425794598 91.86334838977942,-62.577389783845724 91.39861956230361,-61.2008780707416 91.257208756746,-58.70763993083358 90.48945054729927,-54.770793793500914 89.56451775813814,-52.89568205123311 88.69973848426044,-51.83324789201757 88.37257657594611,-49.76521173894234 87.25600274172577,-45.64361574756556 85.35517160281489,-43.97556639211554 84.13005811349987,-43.208377921514256 83.71583780554485,-43.20807092151426 83.71563080554485,-42.74652926057976 83.4006627482718,-42.74597326057976 83.4002787482718,-41.20242198772072 82.09329786624328,-37.54273396119825 79.40540787466222,-37.54265196119826 79.4053338746622,-35.875157584471744 77.58250975639257,-35.26562802769613 77.06639895933336,-34.35136221577882 75.91677043629134,-31.092312261358217 72.35413481815772,-29.6662030341136 70.02549400439781,-29.164694178584845 69.39487993422392,-28.555843214235814 68.2124286759291,-26.101314287447423 64.20451951421848,-25.061773551384185 61.4265856513951,-24.677627179624125 60.680533846841044,-24.33408887290113 59.48201547757861,-22.751981771562008 55.25419761633039,-22.22599299284076 52.12740148847233,-21.97686249920786 51.25824813026124,-21.87664143609628 50.05064407637416,-21.16666755926895 45.83012900314192,-21.24934261916168 42.49206735797138,-21.16618900939818 41.490115940493965,-21.30411346980427 40.280657096634705,-21.403283997005033 36.27657976533635,-22.146821555224367 32.890954474618624,-22.276760437777533 31.751521119560344,-22.65968432121482 30.55568420883266,-23.453187364169914 26.94254598764578,-24.859829693739126 23.68482772995706,-25.265898147168926 22.416712404961952,-25.90547725384532 21.263156580114128,-27.241493632701143 18.169004741741176,-29.261434359233164 15.210294898973663,-30.018731251728198 13.844421260579768,-30.923141427856915 12.776308101660826,-32.62981401927079 10.276458017808515,-32.62987901927078 10.27638001780852,-35.12323876228157 7.815971132828589,-36.352611040666645 6.364076027696136,-37.59935871772962 5.372574203950627,-39.54552858018222 3.452123841871511,-42.323021293523965 1.615984041543665,-44.02413006577606 0.263142178584857,-45.58582005428551 -0.540980992537969,-47.65040317884569 -1.905831826486398,-50.54011406247069 -3.091975516322461,-52.73847615315894 -4.223924820375864,-54.59242258143956 -4.755332292351961,-56.63847350978536 -5.595177694012406,-59.4773018084374 -6.1555137006869,-62.160761869738764 -6.924689500792134,-64.25451423666357 -7.098453481982959,-66.17036196913313 -7.47660895842305,-68.81919707265712 -7.477284080570242,-71.92889405950604 -7.735362990601814,-74.18000522116247 -7.47865041715461,-75.88615710242078 -7.479085272808696,-78.24081473804553 -7.015563174234594,-81.66748888043965 -6.624791562222462,-83.96789833820858 -5.888167934734069,-85.41900338331162 -5.602513134825479,-87.41550169488009 -4.784196603823462,-91.00229759503804 -3.635653852831076,-93.22688377556139 -2.40225117615397,-94.40895319126746 -1.917749417219731,-96.02254349215775 -0.852221688549629,-99.08464918348271 0.845536478346783,-99.11360307848574 0.802595194455151,-99.11391007848573 0.802802194455154,-99.3296464042245 0.981373080446989,-99.57458873942024 1.117179251728196,-99.57514473942024 1.117563251728193,-99.54569569401617 1.160203015386745,-101.42209311492985 2.713348730545881,-102.51655795586316 3.436074093623191,-103.67563148821098 4.578664377112915,-106.66457092468465 7.05269169504048,-108.60696932635705 9.439873386913746,-109.43568528418157 10.256804129232727,-110.27828259596744 11.493895072250632,-112.85085498471912 14.655552177280764,-114.31002919799703 17.41325552611064,-114.90507811357386 18.286898978108503,-115.45826274888272 19.58330998547711,-117.43502683147011 23.319209976576808,-118.32860271664927 26.310070078922198,-118.71821943152145 27.223152918855142,-119.00258804538005 28.56594544742864,-120.24091931170017 32.71072558233695,-120.53011464268205 35.77894717157236,-120.73113008387367 36.72814486571109,-120.73114708387368 36.72829686571109,-120.74543072072491 38.063345875097696,-121.16070355095668 42.469188316654446,-120.8272918553238 45.71466239846067))

query I 
SELECT ST_ASTEXT(ST_BUFFER('010700000004000000010300000001000000060000000000000000805bc0a6aaaaaaaaaa45400000000000805bc00000000000805140000000000020594000000000008051404016b29085ac4d4003f5a637bd694040e6a28b2eba68424000000000008056400000000000805bc0a6aaaaaaaaaa45400103000000010000000500000000000000004060400000000000c047400000000000406040c36ddbb66ddb46c0e6a28b2eba68424000000000008056404016b29085ac4d4003f5a637bd69404000000000004060400000000000c04740010300000001000000060000000000000000406040c36ddbb66ddb46c0000000000040604000000000008056c00000000000805bc000000000008056c00000000000805bc0a6aaaaaaaaaa4540e6a28b2eba68424000000000008056400000000000406040c36ddbb66ddb46c001030000000100000005000000000000000020594000000000008051400000000000406040000000000080514000000000004060400000000000c047404016b29085ac4d4003f5a637bd69404000000000002059400000000000805140', 10))
----
POLYGON((-120 43.3333333333333,-120 70,-119.80785280403231 71.95090322016128,-119.23879532511287 73.8268343236509,-118.31469612302546 75.55570233019603,-117.07106781186548 77.07106781186548,-115.55570233019603 78.31469612302546,-113.8268343236509 79.23879532511287,-111.95090322016128 79.80785280403231,-110 80,-27.65493027539471 80,33.78898702636979 99.53016153657738,35.56801991620239 99.92154701741816,37.38853493589182 99.9837216167679,39.190124837118084 99.71462229399164,40.91301033360388 99.12317814302045,42.5000236618935 98.22901411245884,43.89850548813237 97.06179982219389,45.062052218812624 95.66026508368671,55.81443518297072 80,100.5 80,130 80,131.95090322016128 79.80785280403231,133.8268343236509 79.23879532511287,135.55570233019603 78.31469612302546,137.07106781186548 77.07106781186548,138.31469612302544 75.55570233019603,139.23879532511287 73.8268343236509,139.8078528040323 71.95090322016128,140 70,140 47.5,140 -45.7142857142858,140 -90,139.8078528040323 -91.95090322016128,139.23879532511287 -93.8268343236509,138.31469612302544 -95.55570233019603,137.07106781186548 -97.07106781186548,135.55570233019603 -98.31469612302546,133.8268343236509 -99.23879532511287,131.95090322016128 -99.80785280403231,130 -100,-110 -100,-111.95090322016128 -99.80785280403231,-113.8268343236509 -99.23879532511286,-115.55570233019603 -98.31469612302546,-117.07106781186548 -97.07106781186548,-118.31469612302546 -95.55570233019603,-119.23879532511287 -93.8268343236509,-119.80785280403231 -91.95090322016128,-120 -90,-120 43.3333333333333))

query I
SELECT ST_ASTEXT(ST_BUFFER('GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', 50, 'quad_segs=2'))
----
POLYGON((-119.77828750277963 34.986566616082115,-120.73113008387367 36.72814486571109,-120.73114708387368 36.72829686571109,-116.67394284265013 50.25787918945526,-112.61766180554484 70.21208607848574,-110.21260769341367 71.8045306827834,-109.47352540663559 74.26915263634068,-96.22625255673478 81.06523532092523,-80.70973841766305 91.33909531170018,-77.47976972173505 90.68250891643038,-74.60216846308316 92.15876869522774,-59.968365730506946 87.1227996111331,-43.208377921514256 83.71583780554485,-43.20807092151426 83.71563080554485,-42.74652926057976 83.4006627482718,-42.74597326057976 83.4002787482718,-40.91435894916048 80.56569406361986,-37.54273396119825 79.40540787466222,-37.54265196119826 79.4053338746622,-29.470654654691053 62.85555239975986,-21.97686249920786 51.25824813026124,-22.53887896075934 48.64353415798855,-21.16666755926895 45.83012900314192,-27.097383737166936 27.435639110499896,-30.018731251728198 13.844421260579768,-31.863840538187453 12.652173029821283,-32.62981401927079 10.276458017808515,-32.62987901927078 10.27638001780852,-48.723508992859394 1.758016226334216,-62.160761869738764 -6.924689500792134,-64.27077285667508 -6.471155798334442,-66.17036196913313 -7.47660895842305,-82.74450306051399 -2.500342703319764,-98.98669285902143 0.990814698677202,-99.11360307848574 0.802595194455151,-99.11391007848573 0.802802194455154,-99.28016443335842 1.053894583331451,-99.57458873942024 1.117179251728196,-99.57514473942024 1.117563251728193,-99.44606747061707 1.304456380518706,-100.44580077837041 2.814344194736974,-102.51655795586316 3.436074093623191,-110.40905592595472 17.86175475975191,-120.24091931170017 32.71072558233695,-119.77828750277963 34.986566616082115))

query I
SELECT ST_ASTEXT(ST_BUFFER('GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', 50, 'join=bevel'))
----
POLYGON((-120.62474084890896 36.78288512543588,-121.16070355095668 42.469188316654446,-120.15903275674597 52.2195859292584,-117.27440057594612 61.587216107982435,-112.61766180554484 70.21208607848574,-106.36777230495952 77.76274692468465,-98.76491182271923 83.94903098471912,-90.1012540234232 88.5332028314701,-80.70973841766305 91.33909531170018,-70.95127568334556 92.25887955095669,-61.2008780707416 91.257208756746,-51.83324789201757 88.37257657594611,-43.208377921514256 83.71583780554485,-43.20807092151426 83.71563080554485,-42.74652926057976 83.4006627482718,-42.74597326057976 83.4002787482718,-37.844921522290534 79.25038037015577,-37.54273396119825 79.40540787466222,-37.54265196119826 79.4053338746622,-37.51158074136236 78.96812863318132,-35.26562802769613 77.06639895933336,-29.164694178584845 69.39487993422392,-24.677627179624125 60.680533846841044,-21.97686249920786 51.25824813026124,-21.16618900939818 41.490115940493965,-22.276760437777533 31.751521119560344,-25.265898147168926 22.416712404961952,-30.018731251728198 13.844421260579768,-32.66156451018059 10.72322132863664,-32.62981401927079 10.276458017808515,-32.62987901927078 10.27638001780852,-32.95680741570368 10.374537909552913,-36.352611040666645 6.364076027696136,-44.02413006577606 0.263142178584857,-52.73847615315894 -4.223924820375864,-62.160761869738764 -6.924689500792134,-71.92889405950604 -7.735362990601814,-81.66748888043965 -6.624791562222462,-91.00229759503804 -3.635653852831076,-99.08464918348272 0.845536478346783,-99.11360307848574 0.802595194455151,-99.11391007848573 0.802802194455154,-99.3296464042245 0.981373080446989,-99.57458873942024 1.117179251728196,-99.57514473942024 1.117563251728193,-99.54569569401617 1.160203015386745,-106.66457092468465 7.05269169504048,-112.85085498471912 14.655552177280764,-117.43502683147011 23.319209976576808,-120.24091931170017 32.71072558233695,-120.61633260478095 36.693677751051545,-120.73113008387367 36.72814486571109,-120.73114708387368 36.72829686571109,-120.62474084890896 36.78288512543588))

statement error
SELECT ST_BUFFER('aa', 50)

statement error
SELECT ST_BUFFER('MULTIPOINT(100 100 30, 50 74 1000)')

statement error
SELECT ST_BUFFER('MULTIPOINT(100 100 30, 50 74 1000)', 50, 12)
