# name: test/sql/test_extent.test
# description: ST_EXTENT test
# group: [sql]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

#test with POINT
query I
SELECT ST_ASTEXT(ST_EXTENT(['POINT(30 10.2323)'::GEOGRAPHY]))
----
POINT(30 10.2323)

query I 
SELECT ST_ASTEXT(ST_EXTENT(['010100000000000000000024400000000000004B40'::GEOGRAPHY]))
----
POINT(10 54)

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"Point","coordinates":[-71.064544,10.2323]}'::GEOGRAPHY]))
----
POINT(-71.064544 10.2323)

query I
SELECT ST_ASTEXT(ST_EXTENT(['POINT(30 10.2323)'::GEOGRAPHY, '010100000000000000000024400000000000004B40'::GEOGRAPHY]))
----
POLYGON((10 10.2323,10 54,30 54,30 10.2323,10 10.2323))

query I
SELECT ST_ASTEXT(ST_EXTENT(['SRID=4326;POINT(30 10.2323)'::GEOGRAPHY, 'SRID=4326;LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)'::GEOGRAPHY]))
----
POLYGON((-72.126 10.2323,-72.126 42.45666,30 42.45666,30 10.2323,-72.126 10.2323))

#test with LINESTRING
query I
SELECT ST_ASTEXT(ST_EXTENT(['SRID=4326;LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)'::GEOGRAPHY]))
----
POLYGON((-72.126 42.1546,-72.126 42.45666,-72.123 42.45666,-72.123 42.1546,-72.126 42.1546))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['010300000001000000210000009f9eb2d41bf360400000000000002e4032d435e64fcc60402fb55b00da8505406ea475c8695960400000000000000000aa5d4db3a73d5f40fd1cf7917cfc534044f2fd6f73475d40ca0d02908c9851400ae3086e83e35a4081446599b0444f40e88b46e15b295840496e29de585a4c404f22fd2fd133554039af2867c08e4a400700000000205240a08535ad90f349407dbb05a05d184e402aaf2867c08e4a404de8723d482d48403b6e29de585a4c40073aee23f9b8424073446599b0444f402837084032e23b40bc0d02908c9851401e89ca3261093440ef1cf7917cfc534024b9a57863692c400000000000000000e2bca29c013b25402fb55b00da8505407916d6b442ce22400000000000002e40aabca29c013b25405a89f4bf444f3b40ebb8a57863692c407b178dc2b7924340ca88ca326109344015c611dc06074940f036084032e23b4088e4fbdfe6ce4d40cf39ee23f9b84240aa5d4db3a7dd504014e8723d482d4840dc48eb90d352524053bb05a05d184e4064a86bcc9f385340f2ffffffff1f52403e3d65a9378653403a22fd2fd133554064a86bcc9f385340d38b46e15b295840dc48eb90d35252400ae3086e83e35a40aa5d4db3a7dd504044f2fd6f73475d4088e4fbdfe6ce4d40aa5d4db3a73d5f4015c611dc060749406ea475c86959604008188dc2b792434032d435e64fcc60405a89f4bf444f3b409f9eb2d41bf360400000000000002e40'::GEOGRAPHY]))
----
POLYGON((9.40285267938019 0,9.40285267938019 79.9451031602111,135.59714732062 79.9451031602111,135.59714732062 0,9.40285267938019 0))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"LineString","coordinates":[[1,1],[2,2],[3,3],[4,4]]}'::GEOGRAPHY]))
----
POLYGON((1 1,1 4,4 4,4 1,1 1))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"LineString","coordinates":[[1,1],[2,2],[3,3],[4,4]]}'::GEOGRAPHY, '010200000006000000e44a3d0b42ca51c06ec328081e21454027bf45274bca51c0f67b629d2a214540957cec2e50ca51c07099d3653121454047ded1e65dcb51c0781c510ef83145404871a7835dcb51c0ebdaee75f53145406285c7c15ecb51c0ed88fc0df5314540'::GEOGRAPHY]))
----
POLYGON((-71.1776585052917 1,-71.1776585052917 42.3903825660754,4 42.3903825660754,4 1,-71.1776585052917 1))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"LineString","coordinates":[[1,1],[2,2],[3,3],[4,4]]}'::GEOGRAPHY, 'POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))'::GEOGRAPHY]))
----
POLYGON((-71.17239 1,-71.17239 42.354971,4 42.354971,4 1,-71.17239 1))

#test with POLYGON
query I
SELECT ST_ASTEXT(ST_EXTENT(['POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))'::GEOGRAPHY]))
----
POLYGON((-71.17239 42.353675,-71.17239 42.354971,-71.170511 42.354971,-71.170511 42.353675,-71.17239 42.353675))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['010300000001000000210000009f9eb2d41bf360400000000000002e4032d435e64fcc60402fb55b00da8505406ea475c8695960400000000000000000aa5d4db3a73d5f40fd1cf7917cfc534044f2fd6f73475d40ca0d02908c9851400ae3086e83e35a4081446599b0444f40e88b46e15b295840496e29de585a4c404f22fd2fd133554039af2867c08e4a400700000000205240a08535ad90f349407dbb05a05d184e402aaf2867c08e4a404de8723d482d48403b6e29de585a4c40073aee23f9b8424073446599b0444f402837084032e23b40bc0d02908c9851401e89ca3261093440ef1cf7917cfc534024b9a57863692c400000000000000000e2bca29c013b25402fb55b00da8505407916d6b442ce22400000000000002e40aabca29c013b25405a89f4bf444f3b40ebb8a57863692c407b178dc2b7924340ca88ca326109344015c611dc06074940f036084032e23b4088e4fbdfe6ce4d40cf39ee23f9b84240aa5d4db3a7dd504014e8723d482d4840dc48eb90d352524053bb05a05d184e4064a86bcc9f385340f2ffffffff1f52403e3d65a9378653403a22fd2fd133554064a86bcc9f385340d38b46e15b295840dc48eb90d35252400ae3086e83e35a40aa5d4db3a7dd504044f2fd6f73475d4088e4fbdfe6ce4d40aa5d4db3a73d5f4015c611dc060749406ea475c86959604008188dc2b792434032d435e64fcc60405a89f4bf444f3b409f9eb2d41bf360400000000000002e40'::GEOGRAPHY]))
----
POLYGON((9.40285267938019 0,9.40285267938019 79.9451031602111,135.59714732062 79.9451031602111,135.59714732062 0,9.40285267938019 0))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"Polygon","coordinates":[[[0,0],[0,15],[150,15],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}'::GEOGRAPHY]))
----
POLYGON((0 0,0 15,150 15,150 0,0 0))

query I
SELECT ST_ASTEXT(ST_EXTENT(['POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))'::GEOGRAPHY, '010700000004000000010300000001000000060000000000000000805bc0a6aaaaaaaaaa45400000000000805bc00000000000805140000000000020594000000000008051404016b29085ac4d4003f5a637bd694040e6a28b2eba68424000000000008056400000000000805bc0a6aaaaaaaaaa45400103000000010000000500000000000000004060400000000000c047400000000000406040c36ddbb66ddb46c0e6a28b2eba68424000000000008056404016b29085ac4d4003f5a637bd69404000000000004060400000000000c04740010300000001000000060000000000000000406040c36ddbb66ddb46c0000000000040604000000000008056c00000000000805bc000000000008056c00000000000805bc0a6aaaaaaaaaa4540e6a28b2eba68424000000000008056400000000000406040c36ddbb66ddb46c001030000000100000005000000000000000020594000000000008051400000000000406040000000000080514000000000004060400000000000c047404016b29085ac4d4003f5a637bd69404000000000002059400000000000805140'::GEOGRAPHY, '{"type":"Polygon","coordinates":[[[0,0],[0,15],[150,15],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}'::GEOGRAPHY]))
----
POLYGON((-110 -90,-110 90,150 90,150 -90,-110 -90))

query I
SELECT ST_ASTEXT(ST_EXTENT(['POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))'::GEOGRAPHY, 'MULTIPOINT(10.0 10.0, 5.0 7.4)'::GEOGRAPHY, '{"type":"Polygon","coordinates":[[[0,0],[0,15.0],[15.0,15.0],[15.0,0],[0,0]],[[2.0,2.0],[5.0,2.0],[5.0,5.0],[2.0,5.0],[2.0,2.0]]]}'::GEOGRAPHY]))
----
POLYGON((-71.17239 0,-71.17239 42.354971,15 42.354971,15 0,-71.17239 0))

#test with MULTIPOINT
query I
SELECT ST_ASTEXT(ST_EXTENT(['MULTIPOINT(10.0 10.0, 5.0 7.4)'::GEOGRAPHY]))
----
POLYGON((5 7.4,5 10,10 10,10 7.4,5 7.4))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['0104000000060000000101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f'::GEOGRAPHY]))
----
POINT(0.9 0.9)

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"MultiPoint","coordinates":[[35,14]]}'::GEOGRAPHY]))
----
POINT(35 14)

query I
SELECT ST_ASTEXT(ST_EXTENT(['MULTIPOINT(10.0 10.0, 5.0 7.4)'::GEOGRAPHY, '0104000000060000000101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f0101000000cdccccccccccec3fcdccccccccccec3f'::GEOGRAPHY, '{"type":"MultiPoint","coordinates":[[35,14]]}'::GEOGRAPHY]))
----
POLYGON((0.9 0.9,0.9 14,35 14,35 0.9,0.9 0.9))

query I
SELECT ST_ASTEXT(ST_EXTENT(['MULTIPOINT(10.0 10.0, 5.0 7.4)'::GEOGRAPHY, '0105000000030000000102000000020000006666666666661e40000000000080314000000000000022409a9999999919304001020000000200000000000000000022409a9999999919304033333333333324400000000000002e400102000000020000003333333333332940000000000000294033333333333329400000000000402f40'::GEOGRAPHY, '{"type":"MultiPoint","coordinates":[[35,14]]}'::GEOGRAPHY]))
----
POLYGON((5 7.4,5 17.5,35 17.5,35 7.4,5 7.4))

#test with MULTILINESTRING
query I
SELECT ST_ASTEXT(ST_EXTENT(['MULTILINESTRING((-118.584 38.374,-118.583 38.5),(-71.05957 42.3589, -71.061 43))'::GEOGRAPHY]))
----
POLYGON((-118.584 38.374,-118.584 43,-71.05957 43,-71.05957 38.374,-118.584 38.374))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['0105000000030000000102000000020000006666666666661e40000000000080314000000000000022409a9999999919304001020000000200000000000000000022409a9999999919304033333333333324400000000000002e400102000000020000003333333333332940000000000000294033333333333329400000000000402f40'::GEOGRAPHY]))
----
POLYGON((7.6 12.5,7.6 17.5,12.6 17.5,12.6 12.5,7.6 12.5))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}'::GEOGRAPHY]))
----
POLYGON((-89.734956 31.492072,-89.734956 31.492237999999997,-89.734635 31.492237999999997,-89.734635 31.492072,-89.734956 31.492072))

query I
SELECT ST_ASTEXT(ST_EXTENT(['MULTILINESTRING((-118.584 38.374,-118.583 38.5),(-71.05957 42.3589, -71.061 43))'::GEOGRAPHY, '0105000000030000000102000000020000006666666666661e40000000000080314000000000000022409a9999999919304001020000000200000000000000000022409a9999999919304033333333333324400000000000002e400102000000020000003333333333332940000000000000294033333333333329400000000000402f40'::GEOGRAPHY, '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}'::GEOGRAPHY]))
----
POLYGON((-118.584 12.5,-118.584 43,12.6 43,12.6 12.5,-118.584 12.5))

query I
SELECT ST_ASTEXT(ST_EXTENT(['MULTILINESTRING((-118.584 38.374,-118.583 38.5),(-71.05957 42.3589, -71.061 43))'::GEOGRAPHY, '0106000000030000000103000000020000000500000000000000000010400000000000000000000000000000000000000000000010C000000000000010C00000000000000000000000000000000000000000000010400000000000001040000000000000000005000000000000000000004000000000000000000000000000000000000000000000004000000000000000C00000000000000000000000000000000000000000000000C0000000000000004000000000000000000103000000020000000500000000000000000038400000000000000000000000000000344000000000000010C000000000000030400000000000000000000000000000344000000000000010400000000000003840000000000000000005000000000000000000364000000000000000000000000000003440000000000000004000000000000032400000000000000000000000000000344000000000000000C0000000000000364000000000000000000103000000020000000500000000000000000046400000000000000000000000000000444000000000000010C000000000000042400000000000000000000000000000444000000000000010400000000000004640000000000000000005000000000000000000454000000000000000000000000000004440000000000000004000000000000043400000000000000000000000000000444000000000000000C000000000000045400000000000000000'::GEOGRAPHY, '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}'::GEOGRAPHY]))
----
POLYGON((-118.584 -4,-118.584 43,44 43,44 -4,-118.584 -4))

#test with MULTIPOLYGON
query I
SELECT ST_ASTEXT(ST_EXTENT(['MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))'::GEOGRAPHY]))
----
POLYGON((2.6 10,2.6 20,17.6 20,17.6 10,2.6 10))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['0106000000030000000103000000020000000500000000000000000010400000000000000000000000000000000000000000000010C000000000000010C00000000000000000000000000000000000000000000010400000000000001040000000000000000005000000000000000000004000000000000000000000000000000000000000000000004000000000000000C00000000000000000000000000000000000000000000000C0000000000000004000000000000000000103000000020000000500000000000000000038400000000000000000000000000000344000000000000010C000000000000030400000000000000000000000000000344000000000000010400000000000003840000000000000000005000000000000000000364000000000000000000000000000003440000000000000004000000000000032400000000000000000000000000000344000000000000000C0000000000000364000000000000000000103000000020000000500000000000000000046400000000000000000000000000000444000000000000010C000000000000042400000000000000000000000000000444000000000000010400000000000004640000000000000000005000000000000000000454000000000000000000000000000004440000000000000004000000000000043400000000000000000000000000000444000000000000000C000000000000045400000000000000000'::GEOGRAPHY]))
----
POLYGON((-4 -4,-4 4,44 4,44 -4,-4 -4))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}'::GEOGRAPHY]))
----
POLYGON((-117 32,-117 33,-116 33,-116 32,-117 32))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))'::GEOGRAPHY, '0106000000030000000103000000020000000500000000000000000010400000000000000000000000000000000000000000000010C000000000000010C00000000000000000000000000000000000000000000010400000000000001040000000000000000005000000000000000000004000000000000000000000000000000000000000000000004000000000000000C00000000000000000000000000000000000000000000000C0000000000000004000000000000000000103000000020000000500000000000000000038400000000000000000000000000000344000000000000010C000000000000030400000000000000000000000000000344000000000000010400000000000003840000000000000000005000000000000000000364000000000000000000000000000003440000000000000004000000000000032400000000000000000000000000000344000000000000000C0000000000000364000000000000000000103000000020000000500000000000000000046400000000000000000000000000000444000000000000010C000000000000042400000000000000000000000000000444000000000000010400000000000004640000000000000000005000000000000000000454000000000000000000000000000004440000000000000004000000000000043400000000000000000000000000000444000000000000000C000000000000045400000000000000000'::GEOGRAPHY, '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}'::GEOGRAPHY]))
----
POLYGON((-117 -4,-117 33,44 33,44 -4,-117 -4))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))'::GEOGRAPHY, '010700000004000000010300000001000000060000000000000000805bc0a6aaaaaaaaaa45400000000000805bc00000000000805140000000000020594000000000008051404016b29085ac4d4003f5a637bd694040e6a28b2eba68424000000000008056400000000000805bc0a6aaaaaaaaaa45400103000000010000000500000000000000004060400000000000c047400000000000406040c36ddbb66ddb46c0e6a28b2eba68424000000000008056404016b29085ac4d4003f5a637bd69404000000000004060400000000000c04740010300000001000000060000000000000000406040c36ddbb66ddb46c0000000000040604000000000008056c00000000000805bc000000000008056c00000000000805bc0a6aaaaaaaaaa4540e6a28b2eba68424000000000008056400000000000406040c36ddbb66ddb46c001030000000100000005000000000000000020594000000000008051400000000000406040000000000080514000000000004060400000000000c047404016b29085ac4d4003f5a637bd69404000000000002059400000000000805140'::GEOGRAPHY, '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}'::GEOGRAPHY]))
----
POLYGON((-117 -90,-117 90,130 90,130 -90,-117 -90))

#test with COLLECTION
query I
SELECT ST_ASTEXT(ST_EXTENT(['GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))'::GEOGRAPHY]))
----
POLYGON((-71.161144 42.258729,-71.161144 42.285752,-71.040878 42.285752,-71.040878 42.258729,-71.161144 42.258729))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['010700000004000000010300000001000000060000000000000000805bc0a6aaaaaaaaaa45400000000000805bc00000000000805140000000000020594000000000008051404016b29085ac4d4003f5a637bd694040e6a28b2eba68424000000000008056400000000000805bc0a6aaaaaaaaaa45400103000000010000000500000000000000004060400000000000c047400000000000406040c36ddbb66ddb46c0e6a28b2eba68424000000000008056404016b29085ac4d4003f5a637bd69404000000000004060400000000000c04740010300000001000000060000000000000000406040c36ddbb66ddb46c0000000000040604000000000008056c00000000000805bc000000000008056c00000000000805bc0a6aaaaaaaaaa4540e6a28b2eba68424000000000008056400000000000406040c36ddbb66ddb46c001030000000100000005000000000000000020594000000000008051400000000000406040000000000080514000000000004060400000000000c047404016b29085ac4d4003f5a637bd69404000000000002059400000000000805140'::GEOGRAPHY]))
----
POLYGON((-110 -90,-110 90,130 90,130 -90,-110 -90))

query I 
SELECT ST_ASTEXT(ST_EXTENT(['{"type":"GeometryCollection","geometries":[{"type":"MultiPoint","coordinates":[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]]},{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]},{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}]}'::GEOGRAPHY]))
----
POLYGON((-117 31.492072,-117 33,-89.734635 33,-89.734635 31.492072,-117 31.492072))

query I
SELECT ST_ASTEXT(ST_EXTENT(['GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))'::GEOGRAPHY, '010700000004000000010300000001000000060000000000000000805bc0a6aaaaaaaaaa45400000000000805bc00000000000805140000000000020594000000000008051404016b29085ac4d4003f5a637bd694040e6a28b2eba68424000000000008056400000000000805bc0a6aaaaaaaaaa45400103000000010000000500000000000000004060400000000000c047400000000000406040c36ddbb66ddb46c0e6a28b2eba68424000000000008056404016b29085ac4d4003f5a637bd69404000000000004060400000000000c04740010300000001000000060000000000000000406040c36ddbb66ddb46c0000000000040604000000000008056c00000000000805bc000000000008056c00000000000805bc0a6aaaaaaaaaa4540e6a28b2eba68424000000000008056400000000000406040c36ddbb66ddb46c001030000000100000005000000000000000020594000000000008051400000000000406040000000000080514000000000004060400000000000c047404016b29085ac4d4003f5a637bd69404000000000002059400000000000805140'::GEOGRAPHY, '{"type":"GeometryCollection","geometries":[{"type":"MultiPoint","coordinates":[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]]},{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]},{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}]}'::GEOGRAPHY]))
----
POLYGON((-117 -90,-117 90,130 90,130 -90,-117 -90))

query I
SELECT ST_ASTEXT(ST_EXTENT(['GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))'::GEOGRAPHY, '010100000000000000000024400000000000004B40'::GEOGRAPHY, '{"type":"GeometryCollection","geometries":[{"type":"MultiPoint","coordinates":[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]]},{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]},{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}]}'::GEOGRAPHY]))
----
POLYGON((-117 31.492072,-117 54,10 54,10 31.492072,-117 31.492072))

#test with NULL and empty value

query I
SELECT ST_EXTENT([])
----
(empty)

query I 
SELECT ST_EXTENT(NULL)
----
NULL

# test with invalid input
statement error
SELECT ST_EXTENT(22)

# test with table
statement ok
CREATE TABLE geographies (g Geography);

statement ok
INSERT INTO geographies VALUES('MULTIPOINT(0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9,0.9 0.9)'::GEOGRAPHY), ('01010000000000000000003E40BBB88D06F0762440'), ('POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678))'::GEOGRAPHY), ('0101000000CB49287D21C451C0F0BF95ECD8A44540')

query R
SELECT ST_ASTEXT(ST_EXTENT([g, 'POINT(10 10)'])) FROM geographies
----
POLYGON((0.9 0.9,0.9 10,10 10,10 0.9,0.9 0.9))
POLYGON((10 10,10 10.2323,30 10.2323,30 10,10 10))
POLYGON((-71.04096 10,-71.04096 42.285752,10 42.285752,10 10,-71.04096 10))
POLYGON((-71.064544 10,-71.064544 43.28787,10 43.28787,10 10,-71.064544 10))

statement ok
INSERT INTO geographies VALUES(''::GEOGRAPHY), (NULL::GEOGRAPHY), ('MULTIPOLYGON(((5 90,10 90,10 89,5 90)),((5 90,0 90,0 41,5 90)))')

query R
SELECT ST_ASTEXT(ST_EXTENT([g, 'POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))'])) FROM geographies
----
POLYGON((-71.17239 0.9,-71.17239 42.354971,0.9 42.354971,0.9 0.9,-71.17239 0.9))
POLYGON((-71.17239 10.2323,-71.17239 42.354971,30 42.354971,30 10.2323,-71.17239 10.2323))
POLYGON((-71.17239 42.2856,-71.17239 42.354971,-71.040878 42.354971,-71.040878 42.2856,-71.17239 42.2856))
POLYGON((-71.17239 42.353675,-71.17239 43.28787,-71.064544 43.28787,-71.064544 42.353675,-71.17239 42.353675))
POLYGON((-71.17239 42.353675,-71.17239 42.354971,-71.170511 42.354971,-71.170511 42.353675,-71.17239 42.353675))
POLYGON((-71.17239 42.353675,-71.17239 42.354971,-71.170511 42.354971,-71.170511 42.353675,-71.17239 42.353675))
POLYGON((-71.17239 41,-71.17239 90,10 90,10 41,-71.17239 41))
