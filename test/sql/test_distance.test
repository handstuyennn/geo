# name: test/sql/test_distance.test
# description: ST_DISTANCE test
# group: [sql]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

#test with POINT
#to POINT
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'POINT(-71.04096 42.285752)', false)
----
1954.2758204

#to LINESTRING
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)', true)
----
87332.6399146

#to POLYGON
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571))', false)
----
14698.8047527

#to MULTIPOINT
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'MULTIPOINT(-70.9590 42.1180, -70.9611 42.1223)', false)
----
20286.5956982

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'MULTILINESTRING((-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))')
----
8517.5097174

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('POINT(-110 30)', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
613475.213186

#to COLLECTION
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'GEOMETRYCOLLECTION(POINT(-71.04096 42.285752),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', true)
----
1959.3294247

#test with LINESTRING
#to POINT
query I
SELECT ST_DISTANCE('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'POINT(35.3933982822018 35.3933982822018)')
----
0.0

#to LINESTRING
query I
SELECT ST_DISTANCE('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 90)', 'LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307)')
----
0.0

#to POLYGON
query I
SELECT ST_DISTANCE('LINESTRING(50 75,100 10)', '{"type":"Polygon","coordinates":[[[0,0],[0,50],[150,50],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}')
----
0

#to MULTIPOINT
query I
SELECT ST_DISTANCE('LINESTRING(50 75,100 90)', 'MULTIPOINT(164 31,46 31, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237)')
----
3968091.8472333

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('LINESTRING(50 -75,100 -10)', 'MULTILINESTRING((164 31,60 31),(46 31,40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46,31 90))')
----
5876926.8841976

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932)', 'MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))')
----
7687.8721069

#to COLLECTION
query I
SELECT ST_DISTANCE('LINESTRING(-72.1260 42.45, -72.123 42.1546)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)), POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)))', false)
----
78279.7082732

#test with POLYGON
#to POINT
query I
SELECT ST_DISTANCE('POLYGON((0 0,0 10,100 20, 160 20, 160 10, 100 10,100 0, 0 0))', 'POINT(-50 -50)')
----
7293897.148747

#to LINESTRING
query I
SELECT ST_DISTANCE('POLYGON((0 0,0 10,100 20, 160 20, 160 10, 100 10,100 0, 0 0))', 'LINESTRING(-1 0, 3 3, 50 50, 100 10)')
----
0.0

#to POLYGON
query I
SELECT ST_DISTANCE('POLYGON((175 10 5, 20 40 5, 35 45 5, 50 60 5, 100 10 5, 175 10 5))', '{"type":"Polygon","coordinates":[[[0,0],[0,10],[-170,10],[-170,0],[0,0]]]}')
----
1642444.2591445

#to MULTIPOINT
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOINT(-70.9590 42.1180, -70.9611 42.1223)', false)
----
31022.4224881

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTILINESTRING((-72.1260 42.45, -72.123 42.1546),(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', false)
----
10527.3909664

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))')
----
6998.7382883

#to COLLECTION
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'GEOMETRYCOLLECTION(POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)),LINESTRING(-71.17166 42.353675,-71.172026 42.354044,-71.160837 42.259113,-71.161144 42.25932))', true)
----
0.0

#test with MULTIPOINT
#to POINT
query I
SELECT ST_DISTANCE('MULTIPOINT(60 10,110 10,160 10)', 'POINT(111 10)')
----
109505.7347079

#to LINESTRING
query I
SELECT ST_DISTANCE('MULTIPOINT(60 12,110 12,160 12)', 'LINESTRING(60 13,110 13)')
----
111195.0797346

#to POLYGON
query I
SELECT ST_DISTANCE('MULTIPOINT(-6 12.5, -15.0 15.0)', '{"type":"Polygon","coordinates":[[[6,12],[0,15],[15,15],[15,0],[6,12]],[[2,2],[5,2],[5,5],[2,5],[2,2]]]}')
----
705086.2464523

#to MULTIPOINT
query I
SELECT ST_DISTANCE('MULTIPOINT(60 12,110 12,160 12)', 'MULTIPOINT(115 12, 165 12)')
----
543818.5375156

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('MULTIPOINT(-71.17166 42.353675,-71.172026 42.354044)', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}', false)
----
2037389.0696161

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('MULTIPOINT(60 12,110 12,160 12)', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
8638676.300641

#to COLLECTION
query I
SELECT ST_DISTANCE('MULTIPOINT(-71.040878 42.285678,-71.040943 42.2856)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),MULTIPOINT(-71.17166 42.353675,-71.172026 42.354044))', false)
----
0.0

#test with MULTILINESTRING
#to POINT
query I
SELECT ST_DISTANCE('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'POINT(119 11)')
----
10798816.1356148

#to LINESTRING
query I
SELECT ST_DISTANCE('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'LINESTRING(0 0,30 20)')
----
0.0

#to POLYGON
query I
SELECT ST_DISTANCE('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'POLYGON((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8, 10.6 16.4))')
----
0.0

#to MULTIPOINT
query I
SELECT ST_DISTANCE('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'MULTIPOINT(132 17.8,134 14.8,128 13.6,96 12.8,156 16.4,146 17.8,132 18.6,92 18.2,56 15.8,36 15.0)')
----
1862924.1949729

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'MULTILINESTRING((17.5 15.5 2, 2.0 4.0 20, 5.0 6.0 -2, 12.5 10.0 1, 17.5 15.5 1), (1 10 2, 5 20 1))')
----
0.0

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
11732546.5588649

#to COLLECTION
query I
SELECT ST_DISTANCE('MULTILINESTRING((10.6 16.4,3.0 11.2,7.4 7.0,8.2 11.2,13.0 9.4,13.0 6.2,12.2 4.0,15.6 3.2,16.2 7.6,17.2 8.8),(13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8),(2.2 6.4,6.6 2.8,9.4 3.8,9.4 6.8,11.4 7.6,11.2 3.0,13.2 1.0,16.8 1.8,17.8 3.4,18.6 5.2,18.4 7.4,19.0 10.0,19.0 12.2,18.2 14.8,17.8 17.0,17.6 18.4,15.6 16.4,14.6 17.8,13.2 18.6,9.2 18.2,5.6 15.8,3.6 15.0,6.2 15.0,7.6 12.8,8.8 11.8))', 'GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(10.0 10.0),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')
----
0.0

#test with MULTIPOLYGON
#to POINT
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((2.6 12.5, 2.6 20.0, 12.6 20.0, 12.6 12.5, 2.6 12.5),(5.1 15.0, 10.1 15.0, 7.6 17.5, 5.1 15.0 )),((15.1 10.0, 15.1 20.0, 17.6 17.5, 15.1 10.0)))', 'POINT(26 -20)')
----
3542804.419825

#to LINESTRING
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932)', false)
----
7687.8721069

#to POLYGON
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'POLYGON((13.2 17.8,13.4 14.8,12.8 13.6,9.6 12.8,13.2 10.8,15.0 13.0,17.0 14.2,17.4 11.0,15.6 9.6,15.8 9.0,15.8 8.8, 13.2 17.8))')
----
0.0

#to MULTIPOINT
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'MULTIPOINT(2.6 25.0, 15.1 1.0)')
----
555726.0284143

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}', true)
----
2041683.2942281

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)),((15.1 10.0,15.1 20.0,17.6 17.5,15.1 10.0)))', 'MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)))')
----
0.0

#to COLLECTION
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', false)
----
5960.8112207

#test with COLLECTION
#to POINT
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(10.0 10.0),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POINT(15.0 10.0)')
----
547523.6404502

#to LINESTRING
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', 'LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)', true)
----
79393.821299

#to POLYGON
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POLYGON((1 -1, 4 -1, 4 -4, 1 -4, 1 -1))')
----
767477.6179128

#to MULTIPOINT
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTIPOINT(2.5 17.5,-78.26 40.98)')
----
66717.0478408

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546), POINT(-72.1235 42.3521),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTILINESTRING((-72.1260 42.45, -72.123 42.1546),(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', false)
----
0.0

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTIPOLYGON(((2.6 12.5,2.6 20.0,12.6 20.0,12.6 12.5,10.1 10.0,2.6 12.5),(5.1 15.0,10.1 15.0,7.6 17.5,5.1 15.0)))')
----
0.0

#to COLLECTION
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546), POINT(-72.1240 42.45666),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)) )', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),MULTIPOINT(-71.17166 42.353675,-71.172026 42.354044))', false)
----
4056.9577619

#test with NULL and empty value
query I
SELECT ST_DISTANCE('', 'GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')
----
0.0

query I 
SELECT ST_DISTANCE(NULL, NULL)
----
NULL

# test with invalid input
statement error
SELECT ST_DISTANCE(22, 'GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

statement error
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3), POINT(2.5 16.9),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

# test with table
statement ok
CREATE TABLE geographies (g Geography);

statement ok
INSERT INTO geographies VALUES('MULTIPOINT(89 11.4,0.9 0.9,0.9 0.9,1.9 0.9,0.9 1.9,0.9 0.9)'::GEOGRAPHY), ('LINESTRING(2.5 16.9,8.9 11.4,4.0 7.0,8.6 4.3)'::GEOGRAPHY), ('01010000000f48c2be9dc251c0e597c11891244540'), ('POLYGON((2.5 16.9,1.0 90,1.0 89,2.5 16.9))'::GEOGRAPHY), ('0101000000CB49287D21C451C0F0BF95ECD8A44540')

query R
SELECT ST_DISTANCE(g, 'POINT(-50 50)') FROM geographies
----
7171694.6895959
5930900.8010112
1825195.0717544
3407151.7179714
1764790.7535486

statement ok
INSERT INTO geographies VALUES(''::GEOGRAPHY), (NULL::GEOGRAPHY), ('POINT(-71.102923838298 42.3149156848307)')

query R
SELECT ST_DISTANCE(g, 'POINT(-71.17239 42.354358)') FROM geographies
----
8399801.3190714
7423058.7339354
13237.5602764
5020029.0435301
104173.9111539
0.0
NULL
7199.9369743
