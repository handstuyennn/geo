# name: test/sql/test_multipoint.test
# description: MULTIPOINT tests
# group: [sql]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE geographies (g Geography);

# Insert valid geometry strings
statement ok
INSERT INTO geographies VALUES('010400000002000000010100000000000000000008400000000000001040010100000000000000000020400000000000002240'), ('0104000000050000000101000000c887b40b78cc4940e443da053c2653400101000000c887b40b788c5340ac87b40b78cc5440010100000053e1945c75085a401ec79f142f5f3e400101000000aa704aae3ac45f40c7f127c5cb174e4001010000000000000000c062400000000000805640'), ('01040000000200000001010000004c37894160bd51c0c976be9f1a0f45400101000000e10b93a982bd51c08126c286a70f4540'), ('01040000000200000001010000004c37894160bd51c0c976be9f1a0f45400101000000e10b93a982bd51c08126c286a70f4540')

query T
SELECT * FROM geographies
----
0104000020E610000002000000010100000000000000000008400000000000001040010100000000000000000020400000000000002240
0104000020E6100000050000000101000000C887B40B78CC4940E443DA053C2653400101000000C887B40B788C5340AC87B40B78CC5440010100000053E1945C75085A401EC79F142F5F3E400101000000AA704AAE3AC45F40C7F127C5CB174E4001010000000000000000C062400000000000805640
0104000020E61000000200000001010000004C37894160BD51C0C976BE9F1A0F45400101000000E10B93A982BD51C08126C286A70F4540
0104000020E61000000200000001010000004C37894160BD51C0C976BE9F1A0F45400101000000E10B93A982BD51C08126C286A70F4540

query T
SELECT ST_ASTEXT(g) FROM geographies
----
MULTIPOINT(3 4,8 9)
MULTIPOINT(51.5974135047432 76.5974135047432,78.1948270094864 83.194827009486,104.132163186446 30.37181214238,127.066081593223 60.18590607119,150 90)
MULTIPOINT(-70.959 42.118,-70.9611 42.1223)
MULTIPOINT(-70.959 42.118,-70.9611 42.1223)

statement error
INSERT INTO geographies(('0104000000020000000101000000000000000000084000000000000010400101000000000000000000204000000000000022402'))

# Insert valid strings with text
statement ok
DELETE FROM geographies

statement ok
INSERT INTO geographies VALUES('MULTIPOINT(3 4,8 9,123.43 45.21)'), ('MULTIPOINT(51.597413504 76.59741350472,78.19482700294864 3.19482700486,104.132163186446 30.37181214238,127.066081593223 60.18590607119,150 90)'), ('MULTIPOINT(100 10.01, 50 74.44)')

query T
SELECT * FROM geographies
----
0104000020E6100000030000000101000000000000000000084000000000000010400101000000000000000000204000000000000022400101000000EC51B81E85DB5E407B14AE47E19A4640
0104000020E610000005000000010100000034EFB20B78CC4940833DDA053C2653400101000000B282AD0B788C5340BB02F275018F0940010100000053E1945C75085A401EC79F142F5F3E400101000000AA704AAE3AC45F40C7F127C5CB174E4001010000000000000000C062400000000000805640
0104000020E6100000020000000101000000000000000000594085EB51B81E052440010100000000000000000049405C8FC2F5289C5240

query T
SELECT ST_ASTEXT(g) FROM geographies
----
MULTIPOINT(3 4,8 9,123.43 45.21)
MULTIPOINT(51.597413504 76.59741350472,78.19482700294864 3.19482700486,104.132163186446 30.37181214238,127.066081593223 60.18590607119,150 90)
MULTIPOINT(100 10.01,50 74.44)

statement error
INSERT INTO geographies(('MULTIPOINT(-71.064544 42.28787)'))

# Insert valid strings with geojson
statement ok
DELETE FROM geographies

statement ok
INSERT INTO geographies VALUES('{"type":"MultiPoint","coordinates":[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]]}'), ('{"type":"MultiPoint","coordinates":[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]}'), ('{"type":"MultiPoint","coordinates":[[10,43.28787]]}')

query T
SELECT * FROM geographies
----
0104000020E61000002B00000001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC00000000000004040
0104000020E61000000700000001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000000404001010000000000000000405DC00000000000804040
0104000020E61000000100000001010000000000000000002440F0BF95ECD8A44540

query T
SELECT ST_ASTEXT(g) FROM geographies
----
MULTIPOINT(-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 32,-117 32,-117 32,-117 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-117 32,-117 32,-117 32,-117 32)
MULTIPOINT(-117 33,-117 33,-117 33,-117 33,-117 33,-117 32,-117 33)
MULTIPOINT(10 43.28787)

# Insert invalid geojson string
statement error
INSERT INTO geographies(('{"type":"MultiPoint","coordinates":[[30,10.2323]}'))
